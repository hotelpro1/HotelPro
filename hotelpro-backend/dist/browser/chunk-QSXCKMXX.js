import{a as ie}from"./chunk-JMVZSWSW.js";import{a as te}from"./chunk-B2VF6USO.js";import{d as ee}from"./chunk-6N4QSK7X.js";import{b as L,c as q,d as c,e as j,f as G,k as B,l as V,m as $,n as H,o as W,p as Y,q as z,r as J,s as K,x as Q,y as X,z as Z}from"./chunk-DKI4PBNW.js";import{b as M}from"./chunk-3FS5RTN6.js";import{Ca as b,Db as w,Fb as k,Jb as U,Kb as S,L as C,Ma as n,Mb as O,Nb as D,Oa as R,Xa as E,Za as N,ea as p,fa as f,la as h,na as d,nb as F,ob as T,pb as A,wa as l,wb as x,xa as i,ya as u}from"./chunk-W7CJDNGE.js";var I=r=>({"is-invalid":r});function le(r,m){r&1&&(l(0,"small",31),n(1,"RoomType Name is required"),i())}function ne(r,m){r&1&&(l(0,"small",31),n(1,"RoomType Category is required"),i())}function ae(r,m){r&1&&(l(0,"small",31),n(1,"Description is required"),i())}function re(r,m){if(r&1&&(l(0,"option",32),n(1),i()),r&2){let y=m.$implicit;d("value",y._id),p(),R(" ",y.noShowPolicyName," ")}}function oe(r,m){if(r&1&&(l(0,"option",32),n(1),i()),r&2){let y=m.$implicit;d("value",y._id),p(),R(" ",y.cancelPolicyName," ")}}function me(r,m){r&1&&(l(0,"small",31),n(1," Base rate is required "),i())}function pe(r,m){r&1&&(l(0,"small",31),n(1," Adult rate is required "),i())}function de(r,m){r&1&&(l(0,"small",31),n(1," Child rate is required "),i())}function ce(r,m){if(r&1&&(l(0,"tr",33)(1,"th",34),n(2),i(),l(3,"td"),n(4),i(),l(5,"td"),u(6,"input",35),h(7,me,2,0,"small",8),i(),l(8,"td"),u(9,"input",36),h(10,pe,2,0,"small",8),i(),l(11,"td"),u(12,"input",37),h(13,de,2,0,"small",8),i()()),r&2){let y,e,o,t,a=m.$implicit,s=m.index;d("formGroupName",s),p(2),R(" ",s+1," "),p(2),R(" ",(y=a.get("roomTypeName"))==null?null:y.value," "),p(3),d("ngIf",(((e=a.get("baseRate"))==null?null:e.dirty)||((e=a.get("baseRate"))==null?null:e.touched))&&((e=a.get("baseRate"))==null?null:e.invalid)),p(3),d("ngIf",(((o=a.get("adultRate"))==null?null:o.dirty)||((o=a.get("adultRate"))==null?null:o.touched))&&((o=a.get("adultRate"))==null?null:o.invalid)),p(3),d("ngIf",(((t=a.get("childRate"))==null?null:t.dirty)||((t=a.get("childRate"))==null?null:t.touched))&&((t=a.get("childRate"))==null?null:t.invalid))}}var Ce=(()=>{let m=class m{constructor(e,o,t,a,s,v,g,P){this.crudService=e,this.fb=o,this.alertService=t,this.activeRoute=a,this.authService=s,this.router=v,this.generalModal=g,this.modalService=P,this.propertyUnitId="",this.cancellationPolicyList=[],this.noshowPolicyList=[],this.ratePlanId="Add"}ngOnInit(){this.propertyUnitId=this.authService.getUserInfo()?.user?.propertyUnitId,this.ratePlanId=this.activeRoute.snapshot.paramMap.get("ratePlanId");let e=this.activeRoute.snapshot.paramMap.get("propertyUnitId");e&&(this.propertyUnitId=e),this.ratePlanForm=this.fb.group({_id:[""],ratePlanName:["",c.required],ratePlanShortName:["",c.required],ratePlanDescription:[""],isBaseRate:[!1],active:[!0],cancellationPolicyId:["",c.required],noShowPolicyId:["",c.required],propertyUnitId:[""],isRefundable:[!1],roomTypeRates:this.fb.array([])}),this.ratePlanId=="Add"?this.readRoomTypes():this.readRate(),this.readAllCancelationPolicies(),this.readAllNoShowPolicies()}readRoomTypes(){this.crudService.post(S.READ_ROOMTYPES+this.propertyUnitId).then(e=>{console.log(e);for(let o of e.data)this.addRoomType(o);console.log(this.ratePlanForm.value),this.alertService.successAlert(e.message)}).catch(e=>{console.log(e),this.alertService.errorAlert(e.message)})}createRoomTypeRate(e){return this.fb.group({roomTypeName:[e?.roomTypeName||"",[c.required]],roomTypeId:[e?.roomTypeId||""],baseRate:[e?.baseRate||0,[c.required,c.pattern("[0-9]+(.[0-9]{1,2})?%?")]],adultRate:[e?.adultRate||0,[c.required,c.pattern("[0-9]+(.[0-9]{1,2})?%?")]],childRate:[e?.childRate||0,[c.required,c.pattern("[0-9]+(.[0-9]{1,2})?%?")]]})}addRoomType(e){this.roomTypeRates.push(this.createRoomTypeRate(e))}get roomTypeRates(){return this.ratePlanForm.get("roomTypeRates")}onSubmit(){console.log(this.ratePlanForm.value);let e=this.ratePlanForm.get("_id")?.value?S.UPDATE_RATEPLAN:S.CREATE_RATEPLAN;this.generalModal.openModal("Are you sure want to submit this details?","").then(o=>{if(o){let t=this.ratePlanForm.value;t.propertyUnitId=this.propertyUnitId,this.crudService.post(e,t).then(a=>{console.log(a),this.alertService.successAlert(a.message)}).catch(a=>{console.log(a),this.alertService.errorAlert(a.message)})}else console.log("no")})}readRate(){let e={};this.router.url.includes("/baserate-setup")?e={isBaseRate:!0,propertyUnitId:this.propertyUnitId}:this.ratePlanId?e={ratePlanId:this.ratePlanId,propertyUnitId:this.propertyUnitId}:(this.alertService.errorAlert("No Rate Plan Found !"),window.history.back()),this.crudService.post(S.READ_RATEPLAN,e).then(o=>{console.log(o),this.ratePlanForm.patchValue(o.data);for(let t of o.data.rateRoomTypes)this.addRoomType(t)}).catch(o=>{console.log(o),this.alertService.errorAlert(o?.error?.message)})}readAllNoShowPolicies(){this.crudService.post(S.GET_ALL_NOSHOW_POLICIES+this.propertyUnitId).then(e=>{console.log(e),this.noshowPolicyList=e.data}).catch(e=>{console.log(e),this.alertService.errorAlert(e.message)})}readAllCancelationPolicies(){this.crudService.post(S.GET_ALL_CANCELLATION_POLICIES+this.propertyUnitId).then(e=>{console.log(e),this.cancellationPolicyList=e.data}).catch(e=>{console.log(e),this.alertService.errorAlert(e.message)})}next(){this.router.navigate(["/tax-setup",this.propertyUnitId])}navigateToRoomSetup(){this.router.navigate(["/rooms-review/"+this.propertyUnitId])}};m.\u0275fac=function(o){return new(o||m)(f(O),f(Q),f(D),f(w),f(M),f(k),f(ie),f(ee))},m.\u0275cmp=C({type:m,selectors:[["app-rateplan"]],standalone:!0,features:[E],decls:76,vars:17,consts:[[1,"row","g-0"],[1,"col-9","ps-5","pe-3"],[1,"container","container_form","my-3","rounded"],[3,"formGroup"],[1,"row","row-cols-1","row-cols-md-2"],[1,"col","mt-3"],[1,"form-label"],["type","text","formControlName","ratePlanName","placeholder","Enter Room Plan Name",1,"form-control",3,"ngClass"],["class","text-danger",4,"ngIf"],["type","text","formControlName","ratePlanShortName","placeholder","Enter Rate Plan Short Name",1,"form-control",3,"ngClass"],["type","text","formControlName","ratePlanDescription","placeholder","Enter Description",1,"form-control",3,"ngClass"],["id","options","formControlName","noShowPolicyId",1,"form-control",2,"appearance","auto"],["value",""],[3,"value",4,"ngFor","ngForOf"],["id","options","formControlName","cancellationPolicyId",1,"form-control",2,"appearance","auto"],[1,"d-flex","mt-4"],[1,"mb-3","me-3","form-check"],["type","checkbox","formControlName","isBaseRate",1,"form-check-input"],[1,"form-check-label"],["type","checkbox","formControlName","isRefundable",1,"form-check-input"],["type","checkbox","formControlName","active",1,"form-check-input"],[1,"col-md-12","mt-3"],[1,"table","text-center"],[1,"col"],["formArrayName","roomTypeRates"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"col-md-12","mb-2"],[1,"d-flex","justify-content-center"],["type","button",1,"btn","btn-primary","ms-2",3,"click"],["type","button",1,"btn","btn-primary","ms-2",3,"click","disabled"],[1,"col-3","px-3"],[1,"text-danger"],[3,"value"],[3,"formGroupName"],["scope","row"],["type","number","formControlName","baseRate",1,"text-center","w-100","border-0","form-control"],["type","number","formControlName","adultRate",1,"text-center","w-100","border-0","form-control"],["type","number","formControlName","childRate",1,"text-center","w-100","border-0","form-control"]],template:function(o,t){if(o&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),n(7,"Rate Plan Name"),i(),u(8,"input",7),h(9,le,2,0,"small",8),i(),l(10,"div",5)(11,"label",6),n(12,"Rate Plan Short Name"),i(),u(13,"input",9),h(14,ne,2,0,"small",8),i(),l(15,"div",5)(16,"label",6),n(17,"Description"),i(),u(18,"input",10),h(19,ae,2,0,"small",8),i(),l(20,"div",5)(21,"label",6),n(22,"No Show Policy"),i(),l(23,"div")(24,"select",11)(25,"option",12),n(26,"Select No Show Policy"),i(),h(27,re,2,2,"option",13),i()()(),l(28,"div",5)(29,"label",6),n(30,"Cancellation Policy"),i(),l(31,"div")(32,"select",14)(33,"option",12),n(34,"Select Cancellation Policy"),i(),h(35,oe,2,2,"option",13),i()()(),l(36,"div",5)(37,"div",15)(38,"div",16),u(39,"input",17),l(40,"label",18),n(41,"BaseRate"),i()(),l(42,"div",16),u(43,"input",19),l(44,"label",18),n(45,"Refundable"),i()(),l(46,"div",16),u(47,"input",20),l(48,"label",18),n(49,"Active"),i()()()(),l(50,"div",21)(51,"table",22)(52,"thead")(53,"tr")(54,"th",23),n(55,"Sr No."),i(),l(56,"th",23),n(57,"Room Type"),i(),l(58,"th",23),n(59,"BaseRate"),i(),l(60,"th",23),n(61,"Adult"),i(),l(62,"th",23),n(63,"Child"),i()()(),l(64,"tbody",24),h(65,ce,14,6,"tr",25),i()()(),l(66,"div",26)(67,"div",27)(68,"button",28),b("click",function(){return t.navigateToRoomSetup()}),n(69," Back "),i(),l(70,"button",29),b("click",function(){return t.onSubmit()}),n(71," Submit "),i(),l(72,"button",28),b("click",function(){return t.next()}),n(73," Next "),i()()()()()()(),l(74,"div",30),u(75,"app-property-sidebar"),i()()),o&2){let a,s,v,g,P,_;p(3),d("formGroup",t.ratePlanForm),p(5),d("ngClass",N(11,I,(((a=t.ratePlanForm.get("ratePlanName"))==null?null:a.dirty)||((a=t.ratePlanForm.get("ratePlanName"))==null?null:a.touched))&&((a=t.ratePlanForm.get("ratePlanName"))==null?null:a.invalid))),p(),d("ngIf",(((s=t.ratePlanForm.get("ratePlanName"))==null?null:s.dirty)||((s=t.ratePlanForm.get("ratePlanName"))==null?null:s.touched))&&((s=t.ratePlanForm.get("ratePlanName"))==null?null:s.invalid)),p(4),d("ngClass",N(13,I,(((v=t.ratePlanForm.get("ratePlanShortName"))==null?null:v.dirty)||((v=t.ratePlanForm.get("ratePlanShortName"))==null?null:v.touched))&&((v=t.ratePlanForm.get("ratePlanShortName"))==null?null:v.invalid))),p(),d("ngIf",(((g=t.ratePlanForm.get("ratePlanShortName"))==null?null:g.dirty)||((g=t.ratePlanForm.get("ratePlanShortName"))==null?null:g.touched))&&((g=t.ratePlanForm.get("ratePlanShortName"))==null?null:g.invalid)),p(4),d("ngClass",N(15,I,(((P=t.ratePlanForm.get("ratePlanDescription"))==null?null:P.dirty)||((P=t.ratePlanForm.get("ratePlanDescription"))==null?null:P.touched))&&((P=t.ratePlanForm.get("ratePlanDescription"))==null?null:P.invalid))),p(),d("ngIf",(((_=t.ratePlanForm.get("ratePlanDescription"))==null?null:_.dirty)||((_=t.ratePlanForm.get("ratePlanDescription"))==null?null:_.touched))&&((_=t.ratePlanForm.get("ratePlanDescription"))==null?null:_.invalid)),p(8),d("ngForOf",t.noshowPolicyList),p(8),d("ngForOf",t.cancellationPolicyList),p(30),d("ngForOf",t.roomTypeRates.controls),p(5),d("disabled",t.ratePlanForm.invalid)}},dependencies:[x,F,T,A,X,B,J,K,q,V,L,z,j,G,Z,$,Y,H,W,U,te],styles:[".form-label[_ngcontent-%COMP%]{margin-bottom:0}.form-control.is-invalid[_ngcontent-%COMP%]{background-image:none;padding-right:.375rem .75rem}.container_form[_ngcontent-%COMP%]{background:#00000023}"]});let r=m;return r})();export{Ce as RateplanComponent};

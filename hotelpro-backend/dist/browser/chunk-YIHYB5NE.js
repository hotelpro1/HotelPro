import{d as J}from"./chunk-24LOKUE6.js";import{b as R,c as j,d as F,e as G,f as q,k as O,l as $,m as X,p as L,x as B,y as z,z as H}from"./chunk-VIVXY5RX.js";import{Ba as T,Ca as h,Da as E,Db as V,Ib as P,Jb as b,L as I,La as y,Lb as M,Ma as r,Mb as U,Na as C,Oa as v,R as x,S as f,Xa as N,ea as m,eb as D,fa as p,la as _,na as u,ob as A,pb as k,wa as n,wb as w,xa as i,ya as S}from"./chunk-CWTEAQ4G.js";function K(l,o){if(l&1){let a=T();n(0,"tr")(1,"th"),r(2),i(),n(3,"td")(4,"a",6),h("click",function(){let e=x(a).$implicit,s=E(),c=y(17);return f(s.openTaxForm(c,e))}),r(5),i()(),n(6,"td"),r(7),i(),n(8,"td"),r(9),i()()}if(l&2){let a=o.$implicit,t=o.index;m(2),C(t+1),m(3),v(" ",a==null?null:a.taxName," "),m(2),v("",a==null?null:a.taxPercentage," %"),m(2),C(a!=null&&a.active?"Active":"Deactive")}}function Q(l,o){l&1&&(n(0,"small",22),r(1," Tax Name is required "),i())}function W(l,o){l&1&&(n(0,"small",22),r(1," Tax Percentage is required and must be at least 1% "),i())}function Y(l,o){if(l&1){let a=T();n(0,"div",7)(1,"h4",8),r(2),i(),n(3,"button",9),h("click",function(){let e=x(a).$implicit;return f(e.dismiss(!1))}),i()(),n(4,"div",10)(5,"form",11)(6,"div",12)(7,"label",13),r(8,"Tax Name"),i(),S(9,"input",14),_(10,Q,2,0,"small",15),i(),n(11,"div",12)(12,"label",13),r(13,"Tax Percentage(%)"),i(),S(14,"input",16),_(15,W,2,0,"small",15),i(),n(16,"div",17),S(17,"input",18),n(18,"label",19),r(19,"Status"),i()()()(),n(20,"div",20)(21,"button",21),h("click",function(){let e=x(a).$implicit;return f(e.close(!0))}),r(22),i()()}if(l&2){let a,t,e=E();m(2),v(" ",e.newTax?"Add Tax":"Update Tax"," "),m(3),u("formGroup",e.taxDetailsForm),m(5),u("ngIf",(((a=e.taxDetailsForm.get("taxName"))==null?null:a.dirty)||((a=e.taxDetailsForm.get("taxName"))==null?null:a.touched))&&((a=e.taxDetailsForm.get("taxName"))==null?null:a.invalid)),m(5),u("ngIf",(((t=e.taxDetailsForm.get("taxPercentage"))==null?null:t.dirty)||((t=e.taxDetailsForm.get("taxPercentage"))==null?null:t.touched))&&((t=e.taxDetailsForm.get("taxPercentage"))==null?null:t.invalid)),m(6),u("disabled",e.taxDetailsForm.invalid),m(),v(" ",e.newTax?"Save":"Update"," ")}}var ce=(()=>{let o=class o{constructor(t,e,s,c,g){this.fb=t,this.crudService=e,this.alertService=s,this.activeRoute=c,this.modalService=g,this.propertyUnitId="",this.allTaxes=[],this.newTax=!1}ngOnInit(){this.propertyUnitId=this.activeRoute.snapshot.paramMap.get("propertyUnitId"),this.initForm(),this.loadTaxes()}initForm(){this.taxDetailsForm=this.fb.group({_id:[""],taxName:["",[F.required]],taxPercentage:[0,[F.required,F.min(1)]],active:[!1]})}loadTaxes(){if(!this.propertyUnitId){this.alertService.errorAlert("Property Unit ID is missing");return}this.crudService.post(b.GET_ALL_TAXES+this.propertyUnitId).then(t=>{console.log(t),this.allTaxes=t.data,this.alertService.successAlert(t.message)}).catch(t=>{this.alertService.errorAlert(t.message),console.log(t)})}openTaxForm(t,e){e?(this.newTax=!1,this.taxDetailsForm.patchValue(e)):(this.newTax=!0,this.taxDetailsForm.reset({_id:"",taxPercentage:0,active:!1})),this.modalService.open(t).result.then(s=>{if(s){if(this.taxDetailsForm.invalid)return;console.log(this.taxDetailsForm.value);let c=this.taxDetailsForm.value;c.propertyUnitId=this.propertyUnitId;let g=e?b.UPDATE_TAX+e._id:b.CREATE_TAX;this.crudService.post(g,c).then(d=>{console.log(d),this.loadTaxes(),this.alertService.successAlert(d.message)}).catch(d=>{this.alertService.errorAlert(d.message),console.log(d)})}})}};o.\u0275fac=function(e){return new(e||o)(p(B),p(M),p(U),p(V),p(J))},o.\u0275cmp=I({type:o,selectors:[["app-tax-set"]],standalone:!0,features:[N],decls:18,vars:1,consts:[["taxModal",""],[1,"container-fluid"],[1,"table"],[1,"col"],[4,"ngFor","ngForOf"],["type","button",1,"btn","btn-outline-secondary","ms-2",3,"click"],[1,"link",2,"cursor","pointer",3,"click"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup"],[1,"mb-3"],[1,"form-label"],["type","text","placeholder","Enter Tax Name","formControlName","taxName",1,"form-control"],["class","text-danger",4,"ngIf"],["type","number","placeholder","Enter Tax Percentage","formControlName","taxPercentage",1,"form-control"],[1,"mb-3","form-check"],["type","checkbox","formControlName","active",1,"form-check-input"],[1,"form-check-label"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click","disabled"],[1,"text-danger"]],template:function(e,s){if(e&1){let c=T();n(0,"div",1)(1,"table",2)(2,"thead")(3,"tr")(4,"th",3),r(5,"Sr. No"),i(),n(6,"th",3),r(7,"Tax Name"),i(),n(8,"th",3),r(9,"Percentage"),i(),n(10,"th",3),r(11,"Status"),i()()(),n(12,"tbody"),_(13,K,10,4,"tr",4),i()()(),n(14,"button",5),h("click",function(){x(c);let d=y(17);return f(s.openTaxForm(d))}),r(15,` Add Tax
`),i(),_(16,Y,23,6,"ng-template",null,0,D)}e&2&&(m(13),u("ngForOf",s.allTaxes))},dependencies:[w,A,k,z,O,j,$,R,G,q,H,X,L,P]});let l=o;return l})();export{ce as TaxSetComponent};

import{a as ct,b as st}from"./chunk-QGWSYYYR.js";import{d as lt}from"./chunk-A2YF7YV6.js";import{c as Z,e as tt,j as et,l as nt,u as it,x as ot,y as rt,z as at}from"./chunk-HSWBAXOQ.js";import{b as X}from"./chunk-SGZRKXDW.js";import{Aa as C,Ba as x,Da as S,Ea as m,Eb as G,Gb as Y,Kb as q,Lb as J,M as R,Na as p,Nb as K,Oa as y,Ob as Q,Pa as M,U as O,Ua as D,V as P,Va as b,Wa as T,Ya as U,_a as k,cb as z,eb as j,fa as s,ga as f,ma as u,oa as g,ob as $,pa as N,pb as B,qb as H,ra as F,sa as W,ta as L,ub as v,xa as a,xb as V,ya as l,za as w}from"./chunk-OZVGGEGK.js";var dt=e=>({clean_active:e}),mt=e=>({dirty_active:e});function pt(e,d){if(e&1&&p(0),e&2){let o=m().$implicit;M(" ","Assign-"+(o==null||o.unAssignRooms==null?null:o.unAssignRooms.length)," ")}}function _t(e,d){if(e&1&&(a(0,"th",35),p(1),z(2,"date"),w(3,"br"),a(4,"a",36),u(5,pt,1,1),l()()),e&2){let o=d.$implicit;s(),M(" ",j(2,2,o.date,"dd MMM")," "),s(4),L(5,!(o==null||o.unAssignRooms==null)&&o.unAssignRooms.length?5:-1)}}function gt(e,d){if(e&1&&(a(0,"div")(1,"div",19)(2,"div",45)(3,"div",46),p(4),l()()()()),e&2){let o=m(2).$implicit,t=m(5);F("width:"+t.nightNumber(o.arrival,o.departure)*100+"px;"),W(""+t.setBackground(o)),s(4),M(" ",o.guestName," ")}}function ht(e,d){if(e&1&&(C(0),u(1,gt,5,5,"div",44),x()),e&2){let o=m().$implicit,t=m().$implicit,i=m(4);s(),g("ngIf",i.test(t.date,o))}}function ut(e,d){if(e&1&&(C(0),u(1,ht,2,1,"ng-container",37),x()),e&2){let o=d.$implicit,t=m().$implicit;s(),g("ngIf",o.arrival<=t.date&&o.departure>t.date&&!o.tentative)}}function ft(e,d){if(e&1&&(a(0,"div",48)(1,"div",49)(2,"div",50)(3,"div",51),p(4),l()()()()),e&2){let o=m(2).$implicit,t=m(5);N("width",t.nightNumber(o.startDate,o.endDate)*100+"px"),s(4),y(o.reason)}}function Ct(e,d){if(e&1&&(C(0),u(1,ft,5,3,"div",47),x()),e&2){let o=m().$implicit,t=m().$implicit,i=m(4);s(),g("ngIf",i.testmaintainance(t.date,o))}}function xt(e,d){if(e&1&&(C(0),u(1,Ct,2,1,"ng-container",37),x()),e&2){let o=d.$implicit,t=m().$implicit;s(),g("ngIf",o.startDate<=t.date&&o.endDate>=t.date)}}function vt(e,d){if(e&1&&(a(0,"td")(1,"div",41)(2,"div",42)(3,"div"),p(4),l()(),a(5,"div",43),u(6,ut,2,1,"ng-container",34)(7,xt,2,1,"ng-container",34),l()()()),e&2){let o=d.index,t=m(2).$implicit,i=m().$implicit;s(4),M(" ",i.dailyRates==null||i.dailyRates[o]==null?null:i.dailyRates[o].baseRate," "),s(2),g("ngForOf",t.reservation),s(),g("ngForOf",t.maintenance)}}function St(e,d){if(e&1&&(a(0,"tr")(1,"td",35),p(2),l(),a(3,"td",35),p(4),l(),a(5,"td",35)(6,"div",38)(7,"div",39),p(8," Clean "),l(),a(9,"div",40),p(10," Dirty "),l()()(),u(11,vt,8,3,"td",34),l()),e&2){let o=m().$implicit,t=m().$implicit,i=m();s(2),y(t.roomTypeName),s(2),y(o.roomName),s(3),g("ngClass",k(5,dt,o.roomCondition=="clean")),s(2),g("ngClass",k(7,mt,o.roomCondition=="dirty")),s(2),g("ngForOf",i.DateArr)}}function Mt(e,d){if(e&1&&(C(0),u(1,St,12,9,"tr",37),x()),e&2){let o=m().$implicit;s(),g("ngIf",o.Show)}}function wt(e,d){if(e&1&&(C(0),u(1,Mt,2,1,"ng-container",34),x()),e&2){let o=d.$implicit;s(),g("ngForOf",o.roomDetails)}}var Lt=(()=>{let d=class d{constructor(t,i,n,r,c,_,h){this.crudService=t,this.fb=i,this.alertService=n,this.router=r,this.activeRoute=c,this.modalService=_,this.authService=h,this.propertyUnitId="",this.Week=2,this.dropdownList=[],this.selectedItems=[],this.unAssignReservations=[]}ngOnInit(){this.propertyUnitId=this.authService.getUserInfo()?.user?.propertyUnitId,this.Max=new v("en-US").transform(new Date,"yyyy-MM-dd"),this.Date=new v("en-US").transform(new Date,"yyyy-MM-dd"),this.Today=new v("en-US").transform(new Date,"yyyy-MM-dd"),this.dropdownSettings={singleSelection:!1,idField:"item_id",textField:"item_text",unSelectAllText:"UnSelect All",enableCheckAll:!1,itemsShowLimit:2,allowSearchFilter:!0},this.fetchdata()}fetchdata(){if(this.Week<2&&(this.Week=2),this.Week>52&&(this.Week=52),new Date(this.Date).toISOString()<new Date(this.Today).toISOString()){this.Date=this.Today,this.alertService.errorAlert("You can not visit past data");return}this.startDate=new Date(this.Date.replace(/-/g,"/")),this.endDate=new Date(this.startDate),this.endDate.setDate(this.endDate.getDate()+this.Week*7),this.DateArr=[];for(let n=new Date(this.startDate);n<new Date(this.endDate);n.setDate(n.getDate()+1))this.DateArr.push({date:new Date(n)});let t=this.startDate.toLocaleDateString("en-CA"),i=this.endDate.toLocaleDateString("en-CA");this.crudService.post(J.READ_TAPECHART,{startDate:t,endDate:i,propertyUnitId:this.propertyUnitId}).then(n=>{this.dropdownList=[],this.RoomData=this.roomSort(n.data.tapechartData),this.unAssignReservations=n.data.unAssignReservations,this.DateArr.forEach(r=>{let c=this.unAssignReservations.filter(_=>new Date(_.arrival).toISOString()==r.date.toISOString());r.unAssignRooms=c});for(let r of this.RoomData){for(let c of r.roomDetails){for(let _ of c.reservation)_.arrival=new Date(_.arrival.split("T")[0].replace(/-/g,"/")+" 00:00"),_.departure=new Date(_.departure.split("T")[0].replace(/-/g,"/")+" 00:00");for(let _ of c.maintenance)_.startDate=new Date(_.startDate.split("T")[0].replace(/-/g,"/")+" 00:00"),_.endDate=new Date(_.endDate.split("T")[0].replace(/-/g,"/")+" 00:00")}this.dropdownList.includes(r.roomTypeName)||this.dropdownList.push(r.roomTypeName),r.Show=!0}this.dropdownList=this.dropdownList.map(r=>({item_id:r,item_text:r}))}).catch(n=>{this.alertService.errorAlert(n.statusMessage)})}roomSort(t){return t.sort((i,n)=>i.roomTypeName<n.roomTypeName?-1:i.roomTypeName>n.roomTypeName?1:0),t.map(i=>{i.roomDetails.sort((n,r)=>n.roomName<r.roomName?-1:n.roomName>r.roomName?1:0)}),t}setBackground(t){return t.reservationStatus=="reserved"?"reservation":t.reservationStatus=="inhouse"?"inhouse":t.reservationStatus=="checkedout"?"checkedout":""}add(){this.Week+=1}sub(){this.Week>2&&(this.Week-=1)}test(t,i){return t.toString()==i.arrival.toString()||i.arrival<=this.startDate&&t.toString()==this.startDate.toString()}testmaintainance(t,i){return console.log(t.toString(),i.startDate.toString(),t.toString()==i.startDate.toString()),t.toString()==i.startDate.toString()||i.startDate<=this.startDate&&t.toString()==this.startDate.toString()}nightNumber(t,i){let n=new Date(t),r=new Date(i),c=new Date(this.endDate),_=new Date(this.startDate);_.setUTCHours(0,0,0,0),c.setUTCHours(0,0,0,0),n.setUTCHours(0,0,0,0),r.setUTCHours(0,0,0,0);let h=0;if(n<_){r>c&&(h=Math.abs(r.getTime()-c.getTime()),h=Math.round(h/(24*60*60*1e3)),h+=.3),r.toString()==c.toString()&&(h=.3);let E=(_.getTime()-n.getTime())/(24*60*60*1e3),A=(r.getTime()-n.getTime())/(24*60*60*1e3);return A-E-h>=1?A-E-h:.7}r>c&&(h=Math.abs(r.getTime()-c.getTime()),h=Math.round(h/(1e3*3600*24)),h+=.3),r.toString()==c.toString()&&(h=.3);let I=Math.round((r.getTime()-n.getTime())/(1e3*3600*24));return I-h>=1?I-h:.7}filterRoom(){let t=this.selectedItems.map(i=>i.item_id);if(t.length>0)for(let i of this.RoomData)t.includes(i.roomTypeName)?i.Show=!0:i.Show=!1;else for(let i of this.RoomData)i.Show=!0}};d.\u0275fac=function(i){return new(i||d)(f(K),f(ot),f(Q),f(Y),f(G),f(lt),f(X))},d.\u0275cmp=R({type:d,selectors:[["app-tape-chart"]],standalone:!0,features:[U],decls:54,vars:10,consts:[[1,"p-2",2,"background-color","#f1f8ff"],[1,"mx-3","d-flex","mt-2","bg-white"],[1,"w-100","d-flex","mx-3","justify-content-between"],[1,"d-flex","my-2","align-items-center"],[1,"black_font"],[1,"ms-2"],["type","date",1,"form-control",3,"ngModelChange","ngModel","min"],[1,"black_font","align-items-center","ms-3"],[1,"input_container","ms-2"],["type","number",1,"input","form-control","field","text-center","hide-spinner",3,"ngModelChange","ngModel","min"],[1,"input_img",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","20","height","22","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-plus-circle"],["d","M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"],["d","M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"],[1,"input_img1",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","20","height","22","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-dash-circle"],["d","M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8"],[1,"ms-3"],[1,"btn","btn-success","button","w-auto",3,"click"],[1,"d-flex"],[1,"d-flex","ms-2","align-items-center"],[1,"ms-2","align-self-center",2,"width","200px !important"],["name","roomtype",2,"font-size","13px !important","background","white !important",3,"ngModelChange","onSelect","onDeSelect","placeholder","settings","data","ngModel"],[1,"d-flex","justify-content-right","ms-4"],[1,"align-self-center","d-flex"],[1,"reservation","px-2"],[1,"inhouse","px-2","mt-1"],[1,"renovation","px-2"],[1,"mx-3","mt-2","inline2"],[1,"col-12","pl-0"],["id","scroll",2,"overflow-x","auto","border-right","1px solid rgba(0, 0, 0, 0.1)","max-height","70vh !important"],[1,"table-bordered","global_table",2,"overflow-x","hidden !important"],[2,"z-index","4"],["style","z-index: 3",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[2,"z-index","3"],[1,"link","text-decoration-none"],[4,"ngIf"],[1,"d-flex","justify-content-center"],[1,"clean","px-2",3,"ngClass"],[1,"dirty","px-2",3,"ngClass"],[1,"overlap"],[1,"rate","first-content"],[1,"second-content"],[3,"style","class",4,"ngIf"],[1,"col","d-flex","justify-content-center","text-truncate"],[1,"text-truncate",2,"margin-left","4px !important"],["class","renovation",3,"width",4,"ngIf"],[1,"renovation"],[1,"d-flex","align-items-center",2,"cursor","pointer"],[1,"col","d-flex","justify-content-center",2,"z-index","0","overflow","hidden","padding-left","4px"],[1,"text-truncate"]],template:function(i,n){i&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),p(5,"Start Date :"),l(),a(6,"div",5)(7,"input",6),T("ngModelChange",function(c){return b(n.Date,c)||(n.Date=c),c}),l()(),a(8,"div",7),p(9,"Week :"),l(),a(10,"div",8)(11,"input",9),T("ngModelChange",function(c){return b(n.Week,c)||(n.Week=c),c}),l(),a(12,"div",10),S("click",function(){return n.add()}),O(),a(13,"svg",11),w(14,"path",12)(15,"path",13),l()(),P(),a(16,"div",14),S("click",function(){return n.sub()}),O(),a(17,"svg",15),w(18,"path",12)(19,"path",16),l()()(),P(),a(20,"div",17)(21,"button",18),S("click",function(){return n.fetchdata()}),p(22," Find "),l()()(),a(23,"div",19)(24,"div",19)(25,"div",20)(26,"div",4),p(27,"Filter :"),l()(),a(28,"div",21)(29,"ng-multiselect-dropdown",22),T("ngModelChange",function(c){return b(n.selectedItems,c)||(n.selectedItems=c),c}),S("onSelect",function(){return n.filterRoom()})("onDeSelect",function(){return n.filterRoom()}),l()()(),a(30,"div",23)(31,"div",24)(32,"div")(33,"div",25),p(34,"Reservation"),l(),a(35,"div",26),p(36,"In house"),l()(),a(37,"div")(38,"div",27),p(39,"Maintenance "),l()()()()()()(),a(40,"div",28)(41,"div",29)(42,"div",30)(43,"table",31)(44,"thead")(45,"th",32),p(46,"Room Type"),l(),a(47,"th",32),p(48,"Room"),l(),a(49,"th",32),p(50,"Condition"),l(),u(51,_t,6,5,"th",33),l(),a(52,"tbody"),u(53,wt,2,1,"ng-container",34),l()()()()()()),i&2&&(s(7),D("ngModel",n.Date),g("min",n.Max),s(4),D("ngModel",n.Week),g("min",2),s(18),g("placeholder","Select RoomType")("settings",n.dropdownSettings)("data",n.dropdownList),D("ngModel",n.selectedItems),s(22),g("ngForOf",n.DateArr),s(2),g("ngForOf",n.RoomData))},dependencies:[rt,Z,nt,tt,it,et,st,ct,V,$,B,H,v,at,q],styles:[".input_container[_ngcontent-%COMP%]{position:relative;width:20%}.input_img[_ngcontent-%COMP%], .input_img1[_ngcontent-%COMP%]{bottom:2px;top:6px;width:22px;height:22px;position:absolute;cursor:pointer}.input[_ngcontent-%COMP%]{margin:0}.input_img[_ngcontent-%COMP%]{right:5px}.input_img1[_ngcontent-%COMP%]{left:5px}.hide-spinner[_ngcontent-%COMP%]::-webkit-outer-spin-button, .hide-spinner[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.clean[_ngcontent-%COMP%], .dirty[_ngcontent-%COMP%]{column-width:40px}.clean_active[_ngcontent-%COMP%]{background:#6ccfca;border-radius:10px}.dirty_active[_ngcontent-%COMP%]{background:#ffa4a3;border-radius:10px}.checkedout[_ngcontent-%COMP%], .inhouse[_ngcontent-%COMP%], .reservation[_ngcontent-%COMP%]{font-size:13px;font-weight:500;letter-spacing:1px;text-transform:capitalize;margin-left:2px!important;border-radius:10px!important}.reservation[_ngcontent-%COMP%]{background:#bee2f8!important;color:#000}.inhouse[_ngcontent-%COMP%]{background:#6ccfca!important;color:#000}.checkedout[_ngcontent-%COMP%]{background:#1d366d!important;color:#fff}.renovation[_ngcontent-%COMP%]{background:#ffccd1!important;color:#000;font-size:13px;font-weight:500;letter-spacing:1px;text-transform:capitalize;margin-left:2px!important;border-radius:10px!important}.overlap[_ngcontent-%COMP%]{position:relative}.first-content[_ngcontent-%COMP%]{position:absolute;top:-9px;left:40px;z-index:1}.second-content[_ngcontent-%COMP%]{position:absolute;top:-9px;left:0;z-index:2}.global_table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .global_table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:14px}.global_table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(-n+3), .global_table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(-n+3){position:sticky!important;min-width:115px!important;width:115px!important;max-width:115px!important}.global_table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(1), .global_table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(1){left:0!important}.global_table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(2), .global_table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(2){left:115px!important}.global_table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3), .global_table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(3){left:230px!important}.global_table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(-n+3){background:#fff!important}@media only screen and (max-width: 590px){.clean[_ngcontent-%COMP%], .dirty[_ngcontent-%COMP%]{column-width:15px}}"]});let e=d;return e})();export{Lt as TapeChartComponent};

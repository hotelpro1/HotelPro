import{a as ee}from"./chunk-JMVZSWSW.js";import{a as Z}from"./chunk-B2VF6USO.js";import{d as X}from"./chunk-6N4QSK7X.js";import{c as q,d as _,e as j,f as G,l as R,m as M,n as H,o as Y,p as $,q as B,r as z,s as J,x as K,z as Q}from"./chunk-DKI4PBNW.js";import{b as D}from"./chunk-3FS5RTN6.js";import{Aa as w,Ba as S,Ca as g,Da as u,Db as O,Fb as F,Gb as k,Kb as f,L as E,Ma as l,Mb as W,Nb as U,Oa as x,R as P,S as b,Xa as I,Za as N,ea as d,fa as y,la as h,na as s,nb as L,ob as A,pb as T,wa as n,wb as V,xa as o,ya as C,za as v}from"./chunk-W7CJDNGE.js";var te=r=>({"is-invalid":r});function le(r,m){r&1&&(n(0,"small",34),l(1,"cancelPolicyName is required"),o())}function re(r,m){r&1&&(n(0,"small",34),l(1," Inside Window Charge is required "),o())}function ce(r,m){r&1&&(n(0,"small",34),l(1," Outside Window Charge is required "),o())}function ae(r,m){if(r&1){let c=S();n(0,"button",35),g("click",function(){P(c);let t=u().$implicit;return b(t.disabled?t.enable():t.disable())}),n(1,"i",7),l(2," edit "),o()()}}function de(r,m){if(r&1){let c=S();n(0,"button",36),g("click",function(){P(c);let t=u().index,i=u();return b(i.addUpdateCancellationPolicy(t))}),l(1),o()}if(r&2){let c,e=u().$implicit;s("disabled",e.invalid),d(),x(" ",(c=e.get("_id"))!=null&&c.value?"Update":"Add"," ")}}function se(r,m){if(r&1){let c=S();n(0,"button",37),g("click",function(){P(c);let t=u().index,i=u();return b(i.deleteCancellationPolicy(t))}),l(1," Delete "),o()}}function me(r,m){if(r&1&&(v(0,18),n(1,"tr",19)(2,"td"),C(3,"input",20),h(4,le,2,0,"small",21),o(),n(5,"td")(6,"select",22)(7,"option",23),l(8,"24 Hours"),o(),n(9,"option",24),l(10,"48 Hours"),o()()(),n(11,"td")(12,"select",25)(13,"option",26),l(14,"Percentage"),o(),n(15,"option",27),l(16,"Flat Fee"),o()()(),n(17,"td"),C(18,"input",28),h(19,re,2,0,"small",21),o(),n(20,"td"),C(21,"input",29),h(22,ce,2,0,"small",21),o(),n(23,"td")(24,"div",30),h(25,ae,3,0,"button",31)(26,de,2,2,"button",32)(27,se,2,0,"button",33),o()()(),w()),r&2){let c,e,t,i,a=m.$implicit,p=m.index;d(),s("formGroupName",p),d(2),s("ngClass",N(8,te,(((c=a.get("cancelPolicyName"))==null?null:c.dirty)||((c=a.get("cancelPolicyName"))==null?null:c.touched))&&((c=a.get("cancelPolicyName"))==null?null:c.invalid))),d(),s("ngIf",(((e=a.get("cancelPolicyName"))==null?null:e.dirty)||((e=a.get("cancelPolicyName"))==null?null:e.touched))&&((e=a.get("cancelPolicyName"))==null?null:e.invalid)),d(15),s("ngIf",(((t=a.get("insideWindowCharge"))==null?null:t.dirty)||((t=a.get("insideWindowCharge"))==null?null:t.touched))&&((t=a.get("insideWindowCharge"))==null?null:t.invalid)),d(3),s("ngIf",(((i=a.get("outsideWindowCharge"))==null?null:i.dirty)||((i=a.get("outsideWindowCharge"))==null?null:i.touched))&&((i=a.get("outsideWindowCharge"))==null?null:i.invalid)),d(3),s("ngIf",a.disabled),d(),s("ngIf",!a.disabled),d(),s("ngIf",!a.disabled)}}function pe(r,m){r&1&&(n(0,"small",34),l(1,"Policy Name is required"),o())}function ue(r,m){r&1&&(n(0,"small",34),l(1," Charge Value is required "),o())}function _e(r,m){if(r&1){let c=S();n(0,"button",35),g("click",function(){P(c);let t=u().$implicit;return b(t.disabled?t.enable():t.disable())}),n(1,"i",7),l(2," edit "),o()()}}function he(r,m){if(r&1){let c=S();n(0,"button",36),g("click",function(){P(c);let t=u().index,i=u();return b(i.addUpdateNoShowPolicy(t))}),l(1),o()}if(r&2){let c,e=u().$implicit;s("disabled",e.invalid),d(),x(" ",(c=e.get("_id"))!=null&&c.value?"Update":"Add"," ")}}function ye(r,m){if(r&1){let c=S();n(0,"button",37),g("click",function(){P(c);let t=u().index,i=u();return b(i.deleteNoShowPolicy(t))}),l(1," Delete "),o()}}function ge(r,m){if(r&1&&(v(0,38),n(1,"tr",19)(2,"td"),C(3,"input",39),h(4,pe,2,0,"small",21),o(),n(5,"td")(6,"select",40)(7,"option",26),l(8,"Percentage"),o(),n(9,"option",27),l(10,"Flat Fee"),o()()(),n(11,"td"),C(12,"input",41),h(13,ue,2,0,"small",21),o(),n(14,"td"),C(15,"textarea",42),o(),n(16,"td")(17,"div",30),h(18,_e,3,0,"button",31)(19,he,2,2,"button",32)(20,ye,2,0,"button",33),o()()(),w()),r&2){let c,e,t,i=m.$implicit,a=m.index;d(),s("formGroupName",a),d(2),s("ngClass",N(7,te,(((c=i.get("noShowPolicyName"))==null?null:c.dirty)||((c=i.get("noShowPolicyName"))==null?null:c.touched))&&((c=i.get("noShowPolicyName"))==null?null:c.invalid))),d(),s("ngIf",(((e=i.get("noShowPolicyName"))==null?null:e.dirty)||((e=i.get("noShowPolicyName"))==null?null:e.touched))&&((e=i.get("noShowPolicyName"))==null?null:e.invalid)),d(9),s("ngIf",(((t=i.get("chargeValue"))==null?null:t.dirty)||((t=i.get("chargeValue"))==null?null:t.touched))&&((t=i.get("chargeValue"))==null?null:t.invalid)),d(5),s("ngIf",i.disabled),d(),s("ngIf",!i.disabled),d(),s("ngIf",!i.disabled)}}var Ve=(()=>{let m=class m{constructor(e,t,i,a,p,ie,ne,oe){this.crudService=e,this.fb=t,this.alertService=i,this.activeRoute=a,this.authService=p,this.router=ie,this.generalModal=ne,this.modalService=oe,this.propertyUnitId=""}ngOnInit(){let e=this.activeRoute.snapshot.paramMap.get("propertyUnitId");e&&(this.propertyUnitId=e),this.initForms(),this.readAllCancelationPolicies(),this.readAllNoShowPolicies()}initForms(){this.cancelPolicyListForm=this.fb.group({cancelPolicies:this.fb.array([])}),this.noshowPolicyListForm=this.fb.group({noshowPolicies:this.fb.array([])})}get noshowPolicies(){return this.noshowPolicyListForm.get("noshowPolicies")}readAllNoShowPolicies(){this.crudService.post(f.GET_ALL_NOSHOW_POLICIES+this.propertyUnitId).then(e=>{console.log(e),e.data.forEach(t=>this.addNoShowPolicy(t))}).catch(e=>{console.log(e),this.alertService.errorAlert(e.message)})}createNoShowPolicy(e){let t=this.fb.group({_id:[e?._id||""],noShowPolicyName:[e?.noShowPolicyName||"",_.required],chargeType:[e?.chargeType||"percentage",_.required],chargeValue:[e?.chargeValue||10,_.required],propertyUnitId:[e?.propertyUnitId||this.propertyUnitId,_.required],policyDescription:[e?.policyDescription||""]});return e?._id&&t.disable(),t}addNoShowPolicy(e){this.noshowPolicies.push(this.createNoShowPolicy(e))}addUpdateNoShowPolicy(e){let t=this.noshowPolicies.at(e),i=t.value,a=i._id?f.UPDATE_NOSHOW_POLICY+i._id:f.CREATE_NOSHOW_POLICY;this.crudService.post(a,i).then(p=>{console.log(p),t.patchValue(p.data),t.disable()}).catch(p=>{console.log(p),this.alertService.errorAlert(p.message)})}deleteNoShowPolicy(e){let t=this.noshowPolicies.at(e).value;if(!t._id){this.noshowPolicies.removeAt(e);return}this.crudService.post(f.DELETE_NOSHOW_POLICY+t._id,t).then(i=>{console.log(i),this.noshowPolicies.removeAt(e)}).catch(i=>{console.log(i),this.alertService.errorAlert(i.message)})}get cancelPolicies(){return this.cancelPolicyListForm.get("cancelPolicies")}createCancelPolicy(e){let t=this.fb.group({_id:[e?._id||""],cancelPolicyName:[e?.cancelPolicyName||"",_.required],windowRange:[e?.windowRange||"24h",_.required],windowType:[e?.windowType||"percentage",_.required],insideWindowCharge:[e?.insideWindowCharge||10,_.required],outsideWindowCharge:[e?.outsideWindowCharge||10,_.required],propertyUnitId:[e?.propertyUnitId||this.propertyUnitId,_.required],policyDescription:[e?.policyDescription||""]});return e?._id&&t.disable(),t}addCancelPolicy(e){this.cancelPolicies.push(this.createCancelPolicy(e))}readAllCancelationPolicies(){this.crudService.post(f.GET_ALL_CANCELLATION_POLICIES+this.propertyUnitId).then(e=>{console.log(e),e.data.forEach(t=>this.addCancelPolicy(t))}).catch(e=>{console.log(e),this.alertService.errorAlert(e.message)})}addUpdateCancellationPolicy(e){let t=this.cancelPolicies.at(e),i=this.cancelPolicies.at(e).value,a=i._id?f.UPDATE_CANCELLATION_POLICY+i._id:f.CREATE_CANCELLATION_POLICY;this.crudService.post(a,i).then(p=>{console.log(p),t.patchValue(p.data),t.disable()}).catch(p=>{console.log(p),this.alertService.errorAlert(p.message)})}deleteCancellationPolicy(e){let t=this.cancelPolicies.at(e).value;if(!t._id){this.cancelPolicies.removeAt(e);return}this.crudService.post(f.DELETE_CANCELLATION_POLICY+t._id,t).then(i=>{console.log(i),this.cancelPolicies.removeAt(e)}).catch(i=>{console.log(i),this.alertService.errorAlert(i.message)})}};m.\u0275fac=function(t){return new(t||m)(y(W),y(K),y(U),y(O),y(D),y(F),y(ee),y(X))},m.\u0275cmp=E({type:m,selectors:[["app-policy-list"]],standalone:!0,features:[I],decls:66,vars:6,consts:[[1,"row","flex-md-row","flex-column-reverse","g-0"],[1,"col-md-9","col-12","ps-lg-3","pe-lg-3"],[1,"row","my-4","mx-2"],[1,"col-12"],[1,"card"],[1,"card-header","d-flex","justify-content-between","align-items-center","fw-bold"],["type","button",1,"btn","btn-sm","btn-primary",3,"click"],[1,"material-symbols-rounded"],[1,"card-body"],[3,"formGroup"],[1,"container-fluid"],[1,"table"],["formArrayName","cancelPolicies","class","mt-4 border-top",4,"ngFor","ngForOf"],["formArrayName","noshowPolicies","class","mt-4 border-top",4,"ngFor","ngForOf"],[1,"col-md-12","mb-2"],[1,"d-flex","justify-content-center"],["type","button",1,"btn","btn-primary","ms-2",3,"routerLink"],[1,"col-md-3","col-12","px-3"],["formArrayName","cancelPolicies",1,"mt-4","border-top"],[3,"formGroupName"],["type","text","formControlName","cancelPolicyName","placeholder","Policy",1,"form-control",3,"ngClass"],["class","text-danger",4,"ngIf"],["id","options","formControlName","windowRange",1,"form-control",2,"appearance","auto"],["value","24h"],["value","48h"],["id","options","formControlName","windowType",1,"form-control",2,"appearance","auto"],["value","percentage"],["value","flat"],["type","number","placeholder","Enter insideWindowCharge","formControlName","insideWindowCharge",1,"form-control"],["type","number","placeholder","Enter outsideWindowCharge","formControlName","outsideWindowCharge",1,"form-control"],[1,"d-flex"],["class","btn",3,"click",4,"ngIf"],["type","button","class","btn btn-primary me-2",3,"disabled","click",4,"ngIf"],["type","button","class","btn btn-danger",3,"click",4,"ngIf"],[1,"text-danger"],[1,"btn",3,"click"],["type","button",1,"btn","btn-primary","me-2",3,"click","disabled"],["type","button",1,"btn","btn-danger",3,"click"],["formArrayName","noshowPolicies",1,"mt-4","border-top"],["type","text","formControlName","noShowPolicyName","placeholder","Policy Name",1,"form-control",3,"ngClass"],["formControlName","chargeType",1,"form-control",2,"appearance","auto"],["type","number","placeholder","Charge Value","formControlName","chargeValue",1,"form-control"],["placeholder","Policy Description","formControlName","policyDescription",1,"form-control"]],template:function(t,i){t&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),l(6," Cancellation Policies "),n(7,"button",6),g("click",function(){return i.addCancelPolicy()}),l(8," Add New "),n(9,"i",7),l(10," add "),o()()(),n(11,"div",8),v(12,9),n(13,"div",10)(14,"table",11)(15,"thead")(16,"tr")(17,"th"),l(18,"Name"),o(),n(19,"th"),l(20,"Window Range"),o(),n(21,"th"),l(22,"Window Type"),o(),n(23,"th"),l(24,"InsideWindow Charge"),o(),n(25,"th"),l(26,"OutSideWindow Charge"),o(),n(27,"th"),l(28,"Action"),o()()(),n(29,"tbody"),h(30,me,28,10,"ng-container",12),o()()(),w(),o()()()(),n(31,"div",2)(32,"div",3)(33,"div",4)(34,"div",5),l(35," Noshow Policies "),n(36,"button",6),g("click",function(){return i.addNoShowPolicy()}),l(37," Add New "),n(38,"i",7),l(39," add "),o()()(),n(40,"div",8),v(41,9),n(42,"div",10)(43,"table",11)(44,"thead")(45,"tr")(46,"th"),l(47," Name"),o(),n(48,"th"),l(49,"Charge Type"),o(),n(50,"th"),l(51,"Charge Value"),o(),n(52,"th"),l(53,"Policy Description"),o(),n(54,"th"),l(55,"Action"),o()()(),n(56,"tbody"),h(57,ge,21,9,"ng-container",13),o()()(),w(),o()()()(),n(58,"div",14)(59,"div",15)(60,"button",16),l(61," Back "),o(),n(62,"button",16),l(63," Next "),o()()()(),n(64,"div",17),C(65,"app-property-sidebar"),o()()),t&2&&(d(12),s("formGroup",i.cancelPolicyListForm),d(18),s("ngForOf",i.cancelPolicies.controls),d(11),s("formGroup",i.noshowPolicyListForm),d(16),s("ngForOf",i.noshowPolicies.controls),d(3),s("routerLink","/rooms-review/"+i.propertyUnitId),d(2),s("routerLink","/baserate-setup/"+i.propertyUnitId))},dependencies:[V,L,A,T,k,Q,z,J,q,R,B,j,G,M,$,H,Y,Z],styles:[".card-body[_ngcontent-%COMP%]   .container-fluid[_ngcontent-%COMP%]{overflow-x:auto}"]});let r=m;return r})();export{Ve as PolicyListComponent};

import{a as oe}from"./chunk-WKDVK4O4.js";import{a as re}from"./chunk-EH34FAH4.js";import{d as ae}from"./chunk-A2YF7YV6.js";import{b as B,c as $,d as u,e as H,f as W,k as Y,l as z,m as J,n as K,o as Q,p as X,q as Z,r as ee,s as te,x as ie,y as ne,z as le}from"./chunk-HSWBAXOQ.js";import{b as G}from"./chunk-SGZRKXDW.js";import{Ca as E,Da as b,Ea as T,Eb as D,Gb as L,Kb as q,Lb as P,M as A,Na as a,Nb as V,Ob as j,Pa as R,S as N,T as C,Ya as w,_a as I,fa as m,ga as y,ma as s,oa as c,ob as k,pb as U,qb as M,sa as x,xa as n,xb as O,ya as i,za as f}from"./chunk-OZVGGEGK.js";var F=l=>({"is-invalid":l});function me(l,p){l&1&&(n(0,"small",31),a(1,"RoomType Name is required"),i())}function pe(l,p){l&1&&(n(0,"small",31),a(1,"RoomType Category is required"),i())}function ce(l,p){l&1&&(n(0,"small",31),a(1,"Description is required"),i())}function se(l,p){if(l&1&&(n(0,"option",32),a(1),i()),l&2){let d=p.$implicit;c("value",d._id),m(),R(" ",d.noShowPolicyName," ")}}function de(l,p){if(l&1&&(n(0,"option",32),a(1),i()),l&2){let d=p.$implicit;c("value",d._id),m(),R(" ",d.cancelPolicyName," ")}}function ue(l,p){l&1&&(n(0,"small",31),a(1," Base rate is required "),i())}function he(l,p){l&1&&(n(0,"small",31),a(1," Adult rate is required "),i())}function fe(l,p){l&1&&(n(0,"small",31),a(1," Child rate is required "),i())}function ye(l,p){if(l&1&&(n(0,"tr",33)(1,"th",34),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),f(6,"input",35),s(7,ue,2,0,"small",8),i(),n(8,"td"),f(9,"input",36),s(10,he,2,0,"small",8),i(),n(11,"td"),f(12,"input",37),s(13,fe,2,0,"small",8),i()()),l&2){let d,e,r,t,o=p.$implicit,h=p.index;c("formGroupName",h),m(2),R(" ",h+1," "),m(2),R(" ",(d=o.get("roomTypeName"))==null?null:d.value," "),m(3),c("ngIf",(((e=o.get("baseRate"))==null?null:e.dirty)||((e=o.get("baseRate"))==null?null:e.touched))&&((e=o.get("baseRate"))==null?null:e.invalid)),m(3),c("ngIf",(((r=o.get("adultRate"))==null?null:r.dirty)||((r=o.get("adultRate"))==null?null:r.touched))&&((r=o.get("adultRate"))==null?null:r.invalid)),m(3),c("ngIf",(((t=o.get("childRate"))==null?null:t.dirty)||((t=o.get("childRate"))==null?null:t.touched))&&((t=o.get("childRate"))==null?null:t.invalid))}}function ge(l,p){if(l&1){let d=E();n(0,"button",38),b("click",function(){N(d);let r=T();return C(r.navigateToRoomSetup())}),a(1," Back "),i()}}function ve(l,p){if(l&1){let d=E();n(0,"button",38),b("click",function(){N(d);let r=T();return C(r.next())}),a(1," Next "),i()}}function _e(l,p){l&1&&(n(0,"div",39),f(1,"app-property-sidebar"),i())}var Ue=(()=>{let p=class p{constructor(e,r,t,o,h,g,v,_){this.crudService=e,this.fb=r,this.alertService=t,this.activeRoute=o,this.authService=h,this.router=g,this.generalModal=v,this.modalService=_,this.propertyUnitId="",this.cancellationPolicyList=[],this.noshowPolicyList=[],this.ratePlanId="Add"}ngOnInit(){this.propertyUnitId=this.authService.getUserInfo()?.user?.propertyUnitId,this.ratePlanId=this.activeRoute.snapshot.paramMap.get("ratePlanId");let e=this.activeRoute.snapshot.paramMap.get("propertyUnitId");e&&(this.propertyUnitId=e),this.ratePlanForm=this.fb.group({_id:[""],ratePlanName:["",u.required],ratePlanShortName:["",u.required],ratePlanDescription:[""],isBaseRate:[!1],active:[!0],cancellationPolicyId:["",u.required],noShowPolicyId:["",u.required],propertyUnitId:[""],isRefundable:[!1],roomTypeRates:this.fb.array([])}),this.ratePlanId=="Add"?this.readRoomTypes():this.readRate(),this.readAllCancelationPolicies(),this.readAllNoShowPolicies()}readRoomTypes(){this.crudService.post(P.READ_ROOMTYPES+this.propertyUnitId).then(e=>{console.log(e);for(let r of e.data)this.addRoomType(r);console.log(this.ratePlanForm.value),this.alertService.successAlert(e.message)}).catch(e=>{console.log(e),this.alertService.errorAlert(e.message)})}createRoomTypeRate(e){return this.fb.group({roomTypeName:[e?.roomTypeName||"",[u.required]],roomTypeId:[e?.roomTypeId||""],baseRate:[e?.baseRate||0,[u.required,u.pattern("[0-9]+(.[0-9]{1,2})?%?")]],adultRate:[e?.adultRate||0,[u.required,u.pattern("[0-9]+(.[0-9]{1,2})?%?")]],childRate:[e?.childRate||0,[u.required,u.pattern("[0-9]+(.[0-9]{1,2})?%?")]]})}addRoomType(e){this.roomTypeRates.push(this.createRoomTypeRate(e))}get roomTypeRates(){return this.ratePlanForm.get("roomTypeRates")}onSubmit(){console.log(this.ratePlanForm.value);let e=this.ratePlanForm.get("_id")?.value?P.UPDATE_RATEPLAN:P.CREATE_RATEPLAN;this.generalModal.openModal("Are you sure want to submit this details?","").then(r=>{if(r){let t=this.ratePlanForm.value;t.propertyUnitId=this.propertyUnitId,this.crudService.post(e,t).then(o=>{console.log(o),this.alertService.successAlert(o.message)}).catch(o=>{console.log(o),this.alertService.errorAlert(o.message)})}else console.log("no")})}readRate(){let e={};this.router.url.includes("/baserate-setup")?e={isBaseRate:!0,propertyUnitId:this.propertyUnitId}:this.ratePlanId?e={ratePlanId:this.ratePlanId,propertyUnitId:this.propertyUnitId}:(this.alertService.errorAlert("No Rate Plan Found !"),window.history.back()),this.crudService.post(P.READ_RATEPLAN,e).then(r=>{console.log(r),this.ratePlanForm.patchValue(r.data);for(let t of r.data.rateRoomTypes)this.addRoomType(t)}).catch(r=>{console.log(r),this.alertService.errorAlert(r?.error?.message)})}readAllNoShowPolicies(){this.crudService.post(P.GET_ALL_NOSHOW_POLICIES+this.propertyUnitId).then(e=>{console.log(e),this.noshowPolicyList=e.data}).catch(e=>{console.log(e),this.alertService.errorAlert(e.message)})}readAllCancelationPolicies(){this.crudService.post(P.GET_ALL_CANCELLATION_POLICIES+this.propertyUnitId).then(e=>{console.log(e),this.cancellationPolicyList=e.data}).catch(e=>{console.log(e),this.alertService.errorAlert(e.message)})}next(){this.router.navigate(["/tax-setup",this.propertyUnitId])}navigateToRoomSetup(){this.router.navigate(["/rooms-review/"+this.propertyUnitId])}};p.\u0275fac=function(r){return new(r||p)(y(V),y(ie),y(j),y(D),y(G),y(L),y(oe),y(ae))},p.\u0275cmp=A({type:p,selectors:[["app-rateplan"]],standalone:!0,features:[w],decls:73,vars:22,consts:[[1,"row","g-0"],[1,"ps-5","pe-3"],[1,"container","container_form","my-3","rounded"],[3,"formGroup"],[1,"row","row-cols-1","row-cols-md-2"],[1,"col","mt-3"],[1,"form-label"],["type","text","formControlName","ratePlanName","placeholder","Enter Room Plan Name",1,"form-control",3,"ngClass"],["class","text-danger",4,"ngIf"],["type","text","formControlName","ratePlanShortName","placeholder","Enter Rate Plan Short Name",1,"form-control",3,"ngClass"],["type","text","formControlName","ratePlanDescription","placeholder","Enter Description",1,"form-control",3,"ngClass"],["id","options","formControlName","noShowPolicyId",1,"form-control",2,"appearance","auto"],["value",""],[3,"value",4,"ngFor","ngForOf"],["id","options","formControlName","cancellationPolicyId",1,"form-control",2,"appearance","auto"],[1,"d-flex","mt-4"],[1,"mb-3","me-3","form-check"],["type","checkbox","formControlName","isBaseRate",1,"form-check-input"],[1,"form-check-label"],["type","checkbox","formControlName","isRefundable",1,"form-check-input"],["type","checkbox","formControlName","active",1,"form-check-input"],[1,"col-md-12","mt-3"],[1,"table","text-center"],[1,"col"],["formArrayName","roomTypeRates"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"col-md-12","mb-2"],[1,"d-flex","justify-content-center"],["class","btn btn-primary ms-2","type","button",3,"click",4,"ngIf"],["type","button",1,"btn","btn-primary","ms-2",3,"click","disabled"],["class","col-3 px-3",4,"ngIf"],[1,"text-danger"],[3,"value"],[3,"formGroupName"],["scope","row"],["type","number","formControlName","baseRate",1,"text-center","w-100","border-0","form-control"],["type","number","formControlName","adultRate",1,"text-center","w-100","border-0","form-control"],["type","number","formControlName","childRate",1,"text-center","w-100","border-0","form-control"],["type","button",1,"btn","btn-primary","ms-2",3,"click"],[1,"col-3","px-3"]],template:function(r,t){if(r&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),a(7,"Rate Plan Name"),i(),f(8,"input",7),s(9,me,2,0,"small",8),i(),n(10,"div",5)(11,"label",6),a(12,"Rate Plan Short Name"),i(),f(13,"input",9),s(14,pe,2,0,"small",8),i(),n(15,"div",5)(16,"label",6),a(17,"Description"),i(),f(18,"input",10),s(19,ce,2,0,"small",8),i(),n(20,"div",5)(21,"label",6),a(22,"No Show Policy"),i(),n(23,"div")(24,"select",11)(25,"option",12),a(26,"Select No Show Policy"),i(),s(27,se,2,2,"option",13),i()()(),n(28,"div",5)(29,"label",6),a(30,"Cancellation Policy"),i(),n(31,"div")(32,"select",14)(33,"option",12),a(34,"Select Cancellation Policy"),i(),s(35,de,2,2,"option",13),i()()(),n(36,"div",5)(37,"div",15)(38,"div",16),f(39,"input",17),n(40,"label",18),a(41,"BaseRate"),i()(),n(42,"div",16),f(43,"input",19),n(44,"label",18),a(45,"Refundable"),i()(),n(46,"div",16),f(47,"input",20),n(48,"label",18),a(49,"Active"),i()()()(),n(50,"div",21)(51,"table",22)(52,"thead")(53,"tr")(54,"th",23),a(55,"Sr No."),i(),n(56,"th",23),a(57,"Room Type"),i(),n(58,"th",23),a(59,"BaseRate"),i(),n(60,"th",23),a(61,"Adult"),i(),n(62,"th",23),a(63,"Child"),i()()(),n(64,"tbody",24),s(65,ye,14,6,"tr",25),i()()(),n(66,"div",26)(67,"div",27),s(68,ge,2,0,"button",28),n(69,"button",29),b("click",function(){return t.onSubmit()}),a(70," Submit "),i(),s(71,ve,2,0,"button",28),i()()()()()(),s(72,_e,2,0,"div",30),i()),r&2){let o,h,g,v,_,S;m(),x(t.ratePlanId?"col-12":"col-9"),m(2),c("formGroup",t.ratePlanForm),m(5),c("ngClass",I(16,F,(((o=t.ratePlanForm.get("ratePlanName"))==null?null:o.dirty)||((o=t.ratePlanForm.get("ratePlanName"))==null?null:o.touched))&&((o=t.ratePlanForm.get("ratePlanName"))==null?null:o.invalid))),m(),c("ngIf",(((h=t.ratePlanForm.get("ratePlanName"))==null?null:h.dirty)||((h=t.ratePlanForm.get("ratePlanName"))==null?null:h.touched))&&((h=t.ratePlanForm.get("ratePlanName"))==null?null:h.invalid)),m(4),c("ngClass",I(18,F,(((g=t.ratePlanForm.get("ratePlanShortName"))==null?null:g.dirty)||((g=t.ratePlanForm.get("ratePlanShortName"))==null?null:g.touched))&&((g=t.ratePlanForm.get("ratePlanShortName"))==null?null:g.invalid))),m(),c("ngIf",(((v=t.ratePlanForm.get("ratePlanShortName"))==null?null:v.dirty)||((v=t.ratePlanForm.get("ratePlanShortName"))==null?null:v.touched))&&((v=t.ratePlanForm.get("ratePlanShortName"))==null?null:v.invalid)),m(4),c("ngClass",I(20,F,(((_=t.ratePlanForm.get("ratePlanDescription"))==null?null:_.dirty)||((_=t.ratePlanForm.get("ratePlanDescription"))==null?null:_.touched))&&((_=t.ratePlanForm.get("ratePlanDescription"))==null?null:_.invalid))),m(),c("ngIf",(((S=t.ratePlanForm.get("ratePlanDescription"))==null?null:S.dirty)||((S=t.ratePlanForm.get("ratePlanDescription"))==null?null:S.touched))&&((S=t.ratePlanForm.get("ratePlanDescription"))==null?null:S.invalid)),m(8),c("ngForOf",t.noshowPolicyList),m(8),c("ngForOf",t.cancellationPolicyList),m(30),c("ngForOf",t.roomTypeRates.controls),m(3),c("ngIf",!t.ratePlanId),m(),c("disabled",t.ratePlanForm.invalid),m(2),c("ngIf",!t.ratePlanId),m(),c("ngIf",!t.ratePlanId)}},dependencies:[O,k,U,M,ne,Y,ee,te,$,z,B,Z,H,W,le,J,X,K,Q,q,re],styles:[".form-label[_ngcontent-%COMP%]{margin-bottom:0}.form-control.is-invalid[_ngcontent-%COMP%]{background-image:none;padding-right:.375rem .75rem}.container_form[_ngcontent-%COMP%]{background:#00000023}"]});let l=p;return l})();export{Ue as RateplanComponent};

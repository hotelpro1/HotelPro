import{a as lt,b as ct}from"./chunk-LIPDJV2Z.js";import{d as at}from"./chunk-24LOKUE6.js";import{c as X,e as Z,j as tt,l as et,u as nt,x as it,y as ot,z as rt}from"./chunk-VIVXY5RX.js";import{b as Q}from"./chunk-SWGOWEHE.js";import{Aa as C,Ca as S,Da as p,Db as V,Fb as G,Ib as Y,Jb as q,L as F,Lb as J,Ma as m,Mb as K,Na as w,Oa as y,T as O,Ta as D,U as P,Ua as b,Va as T,Xa as U,Za as k,bb as z,db as L,ea as c,fa as u,la as h,na as _,nb as j,oa as R,ob as $,pb as B,qa as A,ra as W,tb as x,wa as a,wb as H,xa as l,ya as M,za as f}from"./chunk-CWTEAQ4G.js";var dt=n=>({clean_active:n}),st=n=>({dirty_active:n});function mt(n,d){if(n&1&&(a(0,"th",36),m(1),z(2,"date"),M(3,"br"),l()),n&2){let o=d.$implicit;c(),y(" ",L(2,1,o,"dd MMM")," ")}}function pt(n,d){if(n&1&&(a(0,"div")(1,"div",19)(2,"div",45)(3,"div",46),m(4),l()()()()),n&2){let o=p(2).$implicit,t=p(5);A("width:"+t.nightNumber(o.arrival,o.departure)*100+"px;"),W(""+t.setBackground(o)),c(4),y(" ",o.guestName," ")}}function _t(n,d){if(n&1&&(f(0),h(1,pt,5,5,"div",44),C()),n&2){let o=p().$implicit,t=p().$implicit,e=p(4);c(),_("ngIf",e.test(t,o))}}function gt(n,d){if(n&1&&(f(0),h(1,_t,2,1,"ng-container",37),C()),n&2){let o=d.$implicit,t=p().$implicit;c(),_("ngIf",o.arrival<=t&&o.departure>t&&!o.tentative)}}function ht(n,d){if(n&1&&(a(0,"div",48)(1,"div",49)(2,"div",50)(3,"div",51),m(4),l()()()()),n&2){let o=p(2).$implicit,t=p(5);R("width",t.nightNumber(o.startDate,o.endDate)*100+"px"),c(4),w(o.reason)}}function ut(n,d){if(n&1&&(f(0),h(1,ht,5,3,"div",47),C()),n&2){let o=p().$implicit,t=p().$implicit,e=p(4);c(),_("ngIf",e.testmaintainance(t,o))}}function ft(n,d){if(n&1&&(f(0),h(1,ut,2,1,"ng-container",37),C()),n&2){let o=d.$implicit,t=p().$implicit;c(),_("ngIf",o.startDate<=t&&o.endDate>=t)}}function Ct(n,d){if(n&1&&(a(0,"td")(1,"div",41)(2,"div",42)(3,"div"),m(4),l()(),a(5,"div",43),h(6,gt,2,1,"ng-container",35)(7,ft,2,1,"ng-container",35),l()()()),n&2){let o=d.index,t=p(2).$implicit,e=p().$implicit;c(4),y(" ",e.dailyRates==null||e.dailyRates[o]==null?null:e.dailyRates[o].baseRate," "),c(2),_("ngForOf",t.reservation),c(),_("ngForOf",t.maintenance)}}function xt(n,d){if(n&1&&(a(0,"tr")(1,"td",36),m(2),l(),a(3,"td",36),m(4),l(),a(5,"td",36)(6,"div",38)(7,"div",39),m(8," Clean "),l(),a(9,"div",40),m(10," Dirty "),l()()(),h(11,Ct,8,3,"td",35),l()),n&2){let o=p().$implicit,t=p().$implicit,e=p();c(2),w(t.roomTypeName),c(2),w(o.roomName),c(3),_("ngClass",k(5,dt,o.roomCondition=="clean")),c(2),_("ngClass",k(7,st,o.roomCondition=="dirty")),c(2),_("ngForOf",e.DateArr)}}function vt(n,d){if(n&1&&(f(0),h(1,xt,12,9,"tr",37),C()),n&2){let o=p().$implicit;c(),_("ngIf",o.Show)}}function St(n,d){if(n&1&&(f(0),h(1,vt,2,1,"ng-container",35),C()),n&2){let o=d.$implicit;c(),_("ngForOf",o.roomDetails)}}var At=(()=>{let d=class d{constructor(t,e,i,r,s,v,g){this.crudService=t,this.fb=e,this.alertService=i,this.router=r,this.activeRoute=s,this.modalService=v,this.authService=g,this.propertyUnitId="",this.Week=2,this.dropdownList=[],this.selectedItems=[]}ngOnInit(){this.propertyUnitId=this.authService.getUserInfo()?.user?.propertyUnitId,this.Max=new x("en-US").transform(new Date,"yyyy-MM-dd"),this.Date=new x("en-US").transform(new Date,"yyyy-MM-dd"),this.Today=new x("en-US").transform(new Date,"yyyy-MM-dd"),this.dropdownSettings={singleSelection:!1,idField:"item_id",textField:"item_text",unSelectAllText:"UnSelect All",enableCheckAll:!1,itemsShowLimit:2,allowSearchFilter:!0},this.fetchdata()}fetchdata(){if(this.Week<2&&(this.Week=2),new Date(this.Date).toISOString()<new Date(this.Today).toISOString()){this.Date=this.Today,this.alertService.errorAlert("You can not visit past data");return}this.startDate=new Date(this.Date.replace(/-/g,"/")),this.endDate=new Date(this.startDate),this.endDate.setDate(this.endDate.getDate()+this.Week*7),this.DateArr=[];for(let t=new Date(this.startDate);t<new Date(this.endDate);t.setDate(t.getDate()+1))this.DateArr.push(new Date(t));this.crudService.post(q.READ_TAPECHART,{startDate:this.startDate,endDate:this.endDate,propertyUnitId:this.propertyUnitId}).then(t=>{this.dropdownList=[],this.RoomData=this.roomSort(t.data);for(let e of this.RoomData){for(let i of e.roomDetails){for(let r of i.reservation)r.arrival=new Date(r.arrival.split("T")[0].replace(/-/g,"/")+" 00:00"),r.departure=new Date(r.departure.split("T")[0].replace(/-/g,"/")+" 00:00");for(let r of i.maintenance)r.startDate=new Date(r.startDate.split("T")[0].replace(/-/g,"/")+" 00:00"),r.endDate=new Date(r.endDate.split("T")[0].replace(/-/g,"/")+" 00:00")}this.dropdownList.includes(e.roomTypeName)||this.dropdownList.push(e.roomTypeName),e.Show=!0}this.dropdownList=this.dropdownList.map(e=>({item_id:e,item_text:e}))}).catch(t=>{this.alertService.errorAlert(t.statusMessage)})}roomSort(t){return t.sort((e,i)=>e.roomTypeName<i.roomTypeName?-1:e.roomTypeName>i.roomTypeName?1:0),t.map(e=>{e.roomDetails.sort((i,r)=>i.roomName<r.roomName?-1:i.roomName>r.roomName?1:0)}),t}setBackground(t){return t.reservationStatus=="reserved"?"reservation":t.reservationStatus=="inhouse"?"inhouse":t.reservationStatus=="checkedout"?"checkedout":""}add(){this.Week+=1}sub(){this.Week>2&&(this.Week-=1)}test(t,e){return t.toString()==e.arrival.toString()||e.arrival<=this.startDate&&t.toString()==this.startDate.toString()}testmaintainance(t,e){return console.log(t.toString(),e.startDate.toString(),t.toString()==e.startDate.toString()),t.toString()==e.startDate.toString()||e.startDate<=this.startDate&&t.toString()==this.startDate.toString()}nightNumber(t,e){let i=new Date(t),r=new Date(e),s=new Date(this.endDate),v=new Date(this.startDate);v.setUTCHours(0,0,0,0),s.setUTCHours(0,0,0,0),i.setUTCHours(0,0,0,0),r.setUTCHours(0,0,0,0);let g=0;if(i<v){r>s&&(g=Math.abs(r.getTime()-s.getTime()),g=Math.round(g/(24*60*60*1e3)),g+=.3),r.toString()==s.toString()&&(g=.3);let E=(v.getTime()-i.getTime())/(24*60*60*1e3),N=(r.getTime()-i.getTime())/(24*60*60*1e3);return N-E-g>=1?N-E-g:.7}r>s&&(g=Math.abs(r.getTime()-s.getTime()),g=Math.round(g/(1e3*3600*24)),g+=.3),r.toString()==s.toString()&&(g=.3);let I=Math.round((r.getTime()-i.getTime())/(1e3*3600*24));return I-g>=1?I-g:.7}filterRoom(){let t=this.selectedItems.map(e=>e.item_id);if(t.length>0)for(let e of this.RoomData)t.includes(e.roomTypeName)?e.Show=!0:e.Show=!1;else for(let e of this.RoomData)e.Show=!0}};d.\u0275fac=function(e){return new(e||d)(u(J),u(it),u(K),u(G),u(V),u(at),u(Q))},d.\u0275cmp=F({type:d,selectors:[["app-tape-chart"]],standalone:!0,features:[U],decls:56,vars:10,consts:[[1,"p-2",2,"background-color","#f1f8ff"],[1,"mx-3","d-flex","mt-2","bg-white"],[1,"w-100","d-flex","mx-3","justify-content-between"],[1,"d-flex","my-2","align-items-center"],[1,"black_font"],[1,"ms-2"],["type","date",1,"form-control",3,"ngModelChange","ngModel","min"],[1,"black_font","align-items-center","ms-3"],[1,"input_container","ms-2"],["type","number",1,"input","form-control","field","text-center","hide-spinner",3,"ngModelChange","ngModel","min"],[1,"input_img",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","20","height","22","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-plus-circle"],["d","M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"],["d","M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"],[1,"input_img1",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","20","height","22","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-dash-circle"],["d","M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8"],[1,"ms-3"],[1,"btn","btn-success","button","w-auto",3,"click"],[1,"d-flex"],[1,"d-flex","ms-2","align-items-center"],[1,"ms-2","align-self-center",2,"width","200px !important"],["name","roomtype",2,"font-size","13px !important","background","white !important",3,"ngModelChange","onSelect","onDeSelect","placeholder","settings","data","ngModel"],[1,"d-flex","justify-content-right","ms-4"],[1,"align-self-center","d-flex"],[1,"reservation","px-2"],[1,"inhouse","px-2","mt-1"],[1,"checkedout","px-2"],[1,"renovation","px-2","mt-1"],[1,"mx-3","mt-2","inline2"],[1,"col-12","pl-0"],["id","scroll",2,"overflow-x","auto","border-right","1px solid rgba(0, 0, 0, 0.1)","max-height","70vh !important"],[1,"table-bordered","global_table",2,"overflow-x","hidden !important"],[2,"z-index","4"],["style","z-index: 3",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[2,"z-index","3"],[4,"ngIf"],[1,"d-flex","justify-content-center"],[1,"clean","px-2",3,"ngClass"],[1,"dirty","px-2",3,"ngClass"],[1,"overlap"],[1,"rate","first-content"],[1,"second-content"],[3,"style","class",4,"ngIf"],[1,"col","d-flex","justify-content-center","text-truncate"],[1,"text-truncate",2,"margin-left","4px !important"],["class","renovation",3,"width",4,"ngIf"],[1,"renovation"],[1,"d-flex","align-items-center",2,"cursor","pointer"],[1,"col","d-flex","justify-content-center",2,"z-index","0","overflow","hidden","padding-left","4px"],[1,"text-truncate"]],template:function(e,i){e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),m(5,"Start Date :"),l(),a(6,"div",5)(7,"input",6),T("ngModelChange",function(s){return b(i.Date,s)||(i.Date=s),s}),l()(),a(8,"div",7),m(9,"Week :"),l(),a(10,"div",8)(11,"input",9),T("ngModelChange",function(s){return b(i.Week,s)||(i.Week=s),s}),l(),a(12,"div",10),S("click",function(){return i.add()}),O(),a(13,"svg",11),M(14,"path",12)(15,"path",13),l()(),P(),a(16,"div",14),S("click",function(){return i.sub()}),O(),a(17,"svg",15),M(18,"path",12)(19,"path",16),l()()(),P(),a(20,"div",17)(21,"button",18),S("click",function(){return i.fetchdata()}),m(22," Find "),l()()(),a(23,"div",19)(24,"div",19)(25,"div",20)(26,"div",4),m(27,"Filter :"),l()(),a(28,"div",21)(29,"ng-multiselect-dropdown",22),T("ngModelChange",function(s){return b(i.selectedItems,s)||(i.selectedItems=s),s}),S("onSelect",function(){return i.filterRoom()})("onDeSelect",function(){return i.filterRoom()}),l()()(),a(30,"div",23)(31,"div",24)(32,"div")(33,"div",25),m(34,"Reservation"),l(),a(35,"div",26),m(36,"In house"),l()(),a(37,"div")(38,"div",27),m(39,"Checked out"),l(),a(40,"div",28),m(41,"Maintenance "),l()()()()()()(),a(42,"div",29)(43,"div",30)(44,"div",31)(45,"table",32)(46,"thead")(47,"th",33),m(48,"Room Type"),l(),a(49,"th",33),m(50,"Room"),l(),a(51,"th",33),m(52,"Condition"),l(),h(53,mt,4,4,"th",34),l(),a(54,"tbody"),h(55,St,2,1,"ng-container",35),l()()()()()()),e&2&&(c(7),D("ngModel",i.Date),_("min",i.Max),c(4),D("ngModel",i.Week),_("min",2),c(18),_("placeholder","Select RoomType")("settings",i.dropdownSettings)("data",i.dropdownList),D("ngModel",i.selectedItems),c(24),_("ngForOf",i.DateArr),c(2),_("ngForOf",i.RoomData))},dependencies:[ot,X,et,Z,nt,tt,ct,lt,H,j,$,B,x,rt,Y],styles:[".input_container[_ngcontent-%COMP%]{position:relative;width:20%}.input_img[_ngcontent-%COMP%], .input_img1[_ngcontent-%COMP%]{bottom:2px;top:6px;width:22px;height:22px;position:absolute;cursor:pointer}.input[_ngcontent-%COMP%]{margin:0}.input_img[_ngcontent-%COMP%]{right:5px}.input_img1[_ngcontent-%COMP%]{left:5px}.hide-spinner[_ngcontent-%COMP%]::-webkit-outer-spin-button, .hide-spinner[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.clean[_ngcontent-%COMP%], .dirty[_ngcontent-%COMP%]{column-width:40px}.clean_active[_ngcontent-%COMP%]{background:#6ccfca;border-radius:10px}.dirty_active[_ngcontent-%COMP%]{background:#ffa4a3;border-radius:10px}.checkedout[_ngcontent-%COMP%], .inhouse[_ngcontent-%COMP%], .reservation[_ngcontent-%COMP%]{font-size:13px;font-weight:500;letter-spacing:1px;text-transform:capitalize;margin-left:2px!important;border-radius:10px!important}.reservation[_ngcontent-%COMP%]{background:#bee2f8!important;color:#000}.inhouse[_ngcontent-%COMP%]{background:#6ccfca!important;color:#000}.checkedout[_ngcontent-%COMP%]{background:#1d366d!important;color:#fff}.renovation[_ngcontent-%COMP%]{background:#ffccd1!important;color:#000;font-size:13px;font-weight:500;letter-spacing:1px;text-transform:capitalize;margin-left:2px!important;border-radius:10px!important}.overlap[_ngcontent-%COMP%]{position:relative}.first-content[_ngcontent-%COMP%]{position:absolute;top:-9px;left:40px;z-index:1}.second-content[_ngcontent-%COMP%]{position:absolute;top:-9px;left:0;z-index:2}.global_table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .global_table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:14px}.global_table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(-n+3), .global_table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(-n+3){position:sticky!important;min-width:115px!important;width:115px!important;max-width:115px!important}.global_table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(1), .global_table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(1){left:0!important}.global_table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(2), .global_table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(2){left:115px!important}.global_table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3), .global_table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(3){left:230px!important}.global_table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(-n+3){background:#fff!important}@media only screen and (max-width: 590px){.clean[_ngcontent-%COMP%], .dirty[_ngcontent-%COMP%]{column-width:15px}}"]});let n=d;return n})();export{At as TapeChartComponent};

import{a as ce,b as pe}from"./chunk-LIPDJV2Z.js";import{d as de}from"./chunk-24LOKUE6.js";import{c as K,d as b,e as Q,f as X,j as Z,k as $,l as ee,m as te,p as ie,q as ne,r as ae,s as oe,u as re,x as le,y as se,z as me}from"./chunk-VIVXY5RX.js";import{b as J}from"./chunk-SWGOWEHE.js";import{Aa as I,Ba as T,Ca as f,Da as w,Db as B,Fb as G,Ib as q,Jb as M,L as k,La as O,Lb as H,Ma as m,Mb as Y,Na as V,Oa as y,R as u,S as h,T as F,Ta as C,U as P,Ua as x,Va as D,Xa as A,bb as N,db as W,ea as s,eb as L,fa as v,la as _,na as c,ob as U,pb as j,tb as R,wa as i,wb as z,xa as t,ya as S,za as E}from"./chunk-CWTEAQ4G.js";function he(a,d){if(a&1&&(i(0,"option",35),m(1),t()),a&2){let l=d.$implicit;c("value",l._id),s(),y(" ",l.ratePlanName," ")}}function _e(a,d){if(a&1&&(i(0,"th"),m(1),N(2,"date"),S(3,"br"),t()),a&2){let l=d.$implicit;s(),y(" ",W(2,1,l,"dd MMM")," ")}}function ge(a,d){if(a&1&&(i(0,"td")(1,"div"),m(2),t()()),a&2){let l=d.$implicit;s(2),y(" ",l==null?null:l.baseRate," ")}}function fe(a,d){if(a&1&&(i(0,"tr")(1,"td",37),m(2),t(),_(3,ge,3,1,"td",32),t()),a&2){let l=w().$implicit;s(2),V(l.roomTypeName),s(),c("ngForOf",l.dailyRates)}}function ve(a,d){if(a&1&&(E(0),_(1,fe,4,2,"tr",36),I()),a&2){let l=d.$implicit;s(),c("ngIf",l.Show)}}function we(a,d){a&1&&(i(0,"small",52),m(1," Please enter valid start date "),t())}function Re(a,d){a&1&&(i(0,"small",52),m(1," Please enter valid end date "),t())}function Se(a,d){if(a&1&&(i(0,"option",35),m(1),t()),a&2){let l=d.$implicit;c("value",l.item_text),s(),y(" ",l.item_text," ")}}function ye(a,d){a&1&&(i(0,"small",52),m(1," Room type is required "),t())}function Ce(a,d){a&1&&(i(0,"small",52),m(1," Please enter valid rate "),t())}function xe(a,d){if(a&1){let l=T();i(0,"div",38)(1,"h4",39),m(2,"Change Rate"),t(),i(3,"button",40),f("click",function(){let e=u(l).$implicit;return h(e.dismiss(!1))}),t()(),i(4,"form",41)(5,"table",42)(6,"tr")(7,"td",5)(8,"div",43),m(9,"Start Date :"),t()(),i(10,"td")(11,"input",44),f("input",function(){u(l);let e=w();return h(e.checkDates())}),t(),_(12,we,2,0,"small",45),t()(),i(13,"tr")(14,"td",5)(15,"div",43),m(16,"End Date :"),t()(),i(17,"td")(18,"input",46),f("input",function(){u(l);let e=w();return h(e.checkDates())}),t(),_(19,Re,2,0,"small",45),t()(),i(20,"tr")(21,"td")(22,"div",47),m(23,"Room Type*:"),t()(),i(24,"td")(25,"div")(26,"select",48),_(27,Se,2,2,"option",8),t(),_(28,ye,2,0,"small",45),t()()(),i(29,"tr")(30,"td",5)(31,"div",43),m(32,"New Rate:"),t()(),i(33,"td"),S(34,"input",49),_(35,Ce,2,0,"small",45),t()()()(),i(36,"div",50)(37,"button",51),f("click",function(){u(l);let e=w();return h(e.changeRate())}),m(38," Save "),t()()}if(a&2){let l,n,e,o,r=w();s(4),c("formGroup",r.changeRateForm),s(7),c("min",r.Max),s(),c("ngIf",((l=r.changeRateForm.get("startDate"))==null?null:l.invalid)&&((l=r.changeRateForm.get("startDate"))==null?null:l.touched)),s(6),c("min",r.changeRateForm.controls.endDate.value),s(),c("ngIf",((n=r.changeRateForm.get("endDate"))==null?null:n.invalid)&&((n=r.changeRateForm.get("endDate"))==null?null:n.touched)),s(8),c("ngForOf",r.dropdownList),s(),c("ngIf",((e=r.changeRateForm.get("roomType"))==null?null:e.invalid)&&((e=r.changeRateForm.get("roomType"))==null?null:e.touched)),s(6),c("min",0),s(),c("ngIf",((o=r.changeRateForm.get("newRate"))==null?null:o.invalid)&&((o=r.changeRateForm.get("newRate"))==null?null:o.touched)),s(2),c("disabled",r.changeRateForm.invalid)}}var Le=(()=>{let d=class d{constructor(n,e,o,r,g,p,ue){this.crudService=n,this.fb=e,this.alertService=o,this.router=r,this.activeRoute=g,this.modalService=p,this.authService=ue,this.propertyUnitId="",this.Week=2,this.dropdownList=[],this.selectedItems=[],this.ratePlanList=[],this.RoomTypes=[],this.RatePlanId=""}ngOnInit(){this.propertyUnitId=this.authService.getUserInfo()?.user?.propertyUnitId,this.Max=new R("en-US").transform(new Date,"yyyy-MM-dd"),this.Date=new R("en-US").transform(new Date,"yyyy-MM-dd"),this.Today=new R("en-US").transform(new Date,"yyyy-MM-dd"),this.dropdownSettings={singleSelection:!1,idField:"item_id",textField:"item_text",unSelectAllText:"UnSelect All",enableCheckAll:!1,itemsShowLimit:2,allowSearchFilter:!0},this.changeRateForm=this.fb.group({startDate:[this.Date,b.required],endDate:[this.Date,b.required],roomType:["",b.required],newRate:[0,b.required]}),this.readRatePlans()}readRatePlans(){this.crudService.post(M.READ_RATEPLAN,{propertyUnitId:this.propertyUnitId,fromList:!0}).then(n=>{console.log(n),this.ratePlanList=n.data.ratePlanList;for(let e of this.ratePlanList)if(e.isBaseRate){this.RatePlanId=e._id;break}this.fetchdata()}).catch(n=>{console.log(n),this.alertService.errorAlert(n?.error?.message)})}fetchdata(){if(this.Week<2&&(this.Week=2),new Date(this.Date).toISOString()<new Date(this.Today).toISOString()){this.Date=this.Today,this.alertService.errorAlert("You can not visit past data");return}this.startDate=new Date(this.Date.replace(/-/g,"/")),this.endDate=new Date(this.startDate),this.endDate.setDate(this.endDate.getDate()+this.Week*7),this.DateArr=[];for(let n=new Date(this.startDate);n<new Date(this.endDate);n.setDate(n.getDate()+1))this.DateArr.push(new Date(n));this.crudService.post(M.READ_FUTURE_RATES,{startDate:this.startDate,endDate:this.endDate,ratePlanId:this.RatePlanId,propertyUnitId:this.propertyUnitId}).then(n=>{this.dropdownList=[],this.RoomData=n.data,this.changeRateForm.patchValue({roomType:this.RoomData?.[0].roomTypeName});for(let e of this.RoomData)this.dropdownList.includes(e.roomTypeName)||this.dropdownList.push(e.roomTypeName),e.Show=!0;this.dropdownList=this.dropdownList.map(e=>({item_id:e,item_text:e}))}).catch(n=>{this.alertService.errorAlert(n.statusMessage)})}add(){this.Week+=1}sub(){this.Week>2&&(this.Week-=1)}changeRate(){(this.changeRateForm.controls.startDate.value?.toString()<this.Date||this.changeRateForm.controls.endDate.value?.toString()<this.Date)&&(this.alertService.errorAlert("You can not change rates of past date"),this.modalService.dismissAll()),console.log(this.changeRateForm.value);let n="";for(let e of this.RoomData)if(e.roomTypeName==this.changeRateForm.controls.roomType.value){n=e.ratePlanRoomRateId;break}this.crudService.post(M.UPDATE_FUTURE_RATES,{changeRates:this.changeRateForm.value,ratePlanRoomRateId:n}).then(e=>{this.alertService.successAlert("Rate updated successfully")}).catch(e=>{this.alertService.errorAlert(e.statusMessage)}).finally(()=>{this.ngOnInit(),this.modalService.dismissAll()})}checkDates(){this.changeRateForm.controls.startDate.value?.toString()>=this.changeRateForm.controls.endDate.value?.toString()&&this.changeRateForm.patchValue({endDate:this.changeRateForm.controls.startDate.value})}openRangeUpdateModal(n){this.changeRateForm.patchValue({startDate:this.Date,endDate:this.Date,roomType:this.RoomData?.[0].roomTypeName,newRate:0}),this.modalService.open(n).result.then(e=>{})}filterRoom(){let n=this.selectedItems.map(e=>e.item_id);if(n.length>0)for(let e of this.RoomData)n.includes(e.roomTypeName)?e.Show=!0:e.Show=!1;else for(let e of this.RoomData)e.Show=!0}};d.\u0275fac=function(e){return new(e||d)(v(H),v(le),v(Y),v(G),v(B),v(de),v(J))},d.\u0275cmp=k({type:d,selectors:[["app-future-rates"]],standalone:!0,features:[A],decls:50,vars:12,consts:[["Range",""],[1,"p-2",2,"background-color","#f1f8ff"],[1,"mx-3","d-flex","mt-4","bg-white"],[1,"w-100","d-flex","mx-3","justify-content-between"],[1,"d-flex","my-2","align-items-center"],[1,"black_font"],[1,"ms-1"],["id","options",1,"form-control",2,"appearance","auto",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"black_font","ms-3"],["type","date",1,"form-control",3,"ngModelChange","ngModel","min"],[1,"black_font","align-items-center","ms-3"],[1,"input_container","ms-1"],["type","number",1,"input","form-control","field","text-center","hide-spinner",3,"ngModelChange","ngModel","min"],[1,"input_img",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","20","height","22","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-plus-circle"],["d","M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"],["d","M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"],[1,"input_img1",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","20","height","22","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-dash-circle"],["d","M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8"],[1,"ms-3"],[1,"btn","btn-success","button","w-auto",3,"click"],[1,"d-flex"],[1,"d-flex","ms-2","align-items-center"],[1,"ms-2","align-self-center",2,"width","200px !important"],["name","roomtype",2,"font-size","13px !important","background","white !important",3,"ngModelChange","onSelect","onDeSelect","placeholder","settings","data","ngModel"],[1,"mx-3","mt-4","inline2","pb-3"],[1,"col-12","pl-0"],["id","scroll",2,"overflow-x","auto","border-right","1px solid rgba(0, 0, 0, 0.1)","max-height","600px !important"],[1,"table-bordered","global_table",2,"overflow-x","hidden !important"],[2,"z-index","101"],[4,"ngFor","ngForOf"],[1,"ms-3","d-flex","justify-content-center"],[1,"ms-3","btn","btn-primary","button","w-auto",3,"click"],[3,"value"],[4,"ngIf"],[2,"z-index","10"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"px-2","mt-2",3,"formGroup"],[1,"table","table-sm","table-borderless","add_table"],[1,"mt-2"],["type","date","formControlName","startDate",1,"form-control",3,"input","min"],["class","text-danger",4,"ngIf"],["type","date","formControlName","endDate",1,"form-control",3,"input","min"],[1,"mt-1"],["id","options","formControlName","roomType",1,"form-control",2,"appearance","auto"],["type","number","formControlName","newRate",1,"form-control",3,"min"],[1,"d-flex","justify-content-center"],[1,"btn","btn-success","my-2",3,"click","disabled"],[1,"text-danger"]],template:function(e,o){if(e&1){let r=T();i(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),m(5,"Rate Plan :"),t(),i(6,"div",6)(7,"select",7),D("ngModelChange",function(p){return u(r),x(o.RatePlanId,p)||(o.RatePlanId=p),h(p)}),_(8,he,2,2,"option",8),t()(),i(9,"div",9),m(10,"Start Date :"),t(),i(11,"div",6)(12,"input",10),D("ngModelChange",function(p){return u(r),x(o.Date,p)||(o.Date=p),h(p)}),t()(),i(13,"div",11),m(14,"Week :"),t(),i(15,"div",12)(16,"input",13),D("ngModelChange",function(p){return u(r),x(o.Week,p)||(o.Week=p),h(p)}),t(),i(17,"div",14),f("click",function(){return u(r),h(o.add())}),F(),i(18,"svg",15),S(19,"path",16)(20,"path",17),t()(),P(),i(21,"div",18),f("click",function(){return u(r),h(o.sub())}),F(),i(22,"svg",19),S(23,"path",16)(24,"path",20),t()()(),P(),i(25,"div",21)(26,"button",22),f("click",function(){return u(r),h(o.fetchdata())}),m(27," Find "),t()()(),i(28,"div",23)(29,"div",23)(30,"div",24)(31,"div",5),m(32,"Filter :"),t()(),i(33,"div",25)(34,"ng-multiselect-dropdown",26),D("ngModelChange",function(p){return u(r),x(o.selectedItems,p)||(o.selectedItems=p),h(p)}),f("onSelect",function(){return u(r),h(o.filterRoom())})("onDeSelect",function(){return u(r),h(o.filterRoom())}),t()()()()()(),i(35,"div",27)(36,"div",28)(37,"div",29)(38,"table",30)(39,"thead")(40,"th",31),m(41,"Room Type"),t(),_(42,_e,4,4,"th",32),t(),i(43,"tbody"),_(44,ve,2,1,"ng-container",32),t()()()()(),i(45,"div",33)(46,"button",34),f("click",function(){u(r);let p=O(49);return h(o.openRangeUpdateModal(p))}),m(47," Change Rate "),t()()(),_(48,xe,39,10,"ng-template",null,0,L)}e&2&&(s(7),C("ngModel",o.RatePlanId),s(),c("ngForOf",o.ratePlanList),s(4),C("ngModel",o.Date),c("min",o.Max),s(4),C("ngModel",o.Week),c("min",2),s(18),c("placeholder","Select RoomType")("settings",o.dropdownSettings)("data",o.dropdownList),C("ngModel",o.selectedItems),s(8),c("ngForOf",o.DateArr),s(2),c("ngForOf",o.RoomData))},dependencies:[se,$,ae,oe,K,ee,ne,Q,X,re,Z,pe,ce,z,U,j,R,me,te,ie,q],styles:[".input_container[_ngcontent-%COMP%]{position:relative;width:20%}.input_img[_ngcontent-%COMP%], .input_img1[_ngcontent-%COMP%]{bottom:2px;top:6px;width:22px;height:22px;position:absolute;cursor:pointer}.input[_ngcontent-%COMP%]{margin:0}.input_img[_ngcontent-%COMP%]{right:5px}.input_img1[_ngcontent-%COMP%]{left:5px}.hide-spinner[_ngcontent-%COMP%]::-webkit-outer-spin-button, .hide-spinner[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.clean[_ngcontent-%COMP%], .dirty[_ngcontent-%COMP%]{column-width:40px}.clean_active[_ngcontent-%COMP%]{background:#6ccfca;border-radius:10px}.dirty_active[_ngcontent-%COMP%]{background:#ffa4a3;border-radius:10px}.checkedout[_ngcontent-%COMP%], .inhouse[_ngcontent-%COMP%], .reservation[_ngcontent-%COMP%]{font-size:13px;font-weight:500;letter-spacing:1px;text-transform:capitalize;margin-left:2px!important;border-radius:10px!important}.reservation[_ngcontent-%COMP%]{background:#bee2f8!important;color:#000}.inhouse[_ngcontent-%COMP%]{background:#6ccfca!important;color:#000}.checkedout[_ngcontent-%COMP%]{background:#1d366d!important;color:#fff}.renovation[_ngcontent-%COMP%]{background:#ffccd1!important;color:#000;font-size:13px;font-weight:500;letter-spacing:1px;text-transform:capitalize;margin-left:2px!important;border-radius:10px!important}.overlap[_ngcontent-%COMP%]{position:relative}.first-content[_ngcontent-%COMP%]{position:absolute;top:-9px;left:40px;z-index:1}.second-content[_ngcontent-%COMP%]{position:absolute;top:-9px;left:0;z-index:2}.global_table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .global_table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:14px}@media only screen and (max-width: 590px){.clean[_ngcontent-%COMP%], .dirty[_ngcontent-%COMP%]{column-width:15px}}"]});let a=d;return a})();export{Le as FutureRatesComponent};

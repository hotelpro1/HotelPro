import{a as Me,b as $e,c as We}from"./chunk-CFB56TVD.js";import{d as ze}from"./chunk-6N4QSK7X.js";import{b as Ee,c as be,d as f,e as Re,f as Fe,j as Ie,k as Ne,l as we,m as De,n as Te,o as Ve,p as ke,q as Oe,r as Ae,s as je,w as Pe,x as Le,y as Ge,z as qe}from"./chunk-DKI4PBNW.js";import{b as Se}from"./chunk-3FS5RTN6.js";import{Ba as j,Ca as x,Da as h,Db as Q,Fb as ye,Kb as U,L as re,La as H,Ma as l,Mb as Ce,Na as q,Nb as xe,Oa as b,R as y,S as C,Sa as me,Ta as se,Ua as ue,Va as de,Xa as pe,Za as S,a as J,aa as Y,b as le,bb as ce,cb as _e,ea as m,eb as K,fa as G,la as v,na as d,nb as ve,ob as ge,pb as fe,qa as ae,sa as oe,tb as W,wa as n,wb as he,xa as t,ya as g}from"./chunk-W7CJDNGE.js";var E=o=>({"is-invalid":o});function Ue(o,p){if(o&1){let a=j();n(0,"a",42),x("click",function(){let r=y(a).openFileSelector;return C(r())}),l(1,"Add "),n(2,"i",43),l(3," file_present"),t()()}}function Be(o,p){o&1&&(n(0,"small",44),l(1,"First Name is required"),t())}function Ze(o,p){o&1&&(n(0,"small",44),l(1,"Last Name is required"),t())}function Je(o,p){o&1&&(n(0,"small",44),l(1,"Phone is required"),t())}function Ye(o,p){o&1&&(n(0,"small",44),l(1,"Email is not valid"),t())}function He(o,p){o&1&&(n(0,"small",44),l(1,"Address Line 1 is required"),t())}function Ke(o,p){o&1&&(n(0,"small",44),l(1,"City is required"),t())}function Qe(o,p){o&1&&(n(0,"small",44),l(1,"State is required"),t())}function Xe(o,p){o&1&&(n(0,"small",44),l(1,"Country is required"),t())}function et(o,p){o&1&&(n(0,"small",44),l(1,"Zip Code is required"),t())}function tt(o,p){if(o&1){let a=j();n(0,"div"),g(1,"img",45),n(2,"i",46),x("click",function(){let r=y(a).$implicit,e=h();return C(e.deletePhotos(r,e.groupForm))}),l(3," delete "),t()()}if(o&2){let a=p.$implicit;m(),d("src",a,Y)}}function it(o,p){if(o&1&&(n(0,"li",47)(1,"div",8)(2,"div"),l(3),t(),n(4,"div"),l(5),t()()()),o&2){let a,i,r=p.$implicit,e=p.index;d("formGroupName",e),m(3),b(" ",r==null||(a=r.get("roomtype"))==null?null:a.value," "),m(2),b(" ",r==null||(i=r.get("roomCost"))==null?null:i.value," ")}}function nt(o,p){if(o&1){let a=j();n(0,"a",42),x("click",function(){let r=y(a).openFileSelector;return C(r())}),l(1,"Add "),n(2,"i",43),l(3," file_present"),t()()}}function lt(o,p){if(o&1){let a=j();n(0,"button",65),x("click",function(){y(a);let r=h(3).index,e=h();return C(e.addGuest(r))}),n(1,"i",66),l(2," add "),t(),l(3," Add Guest "),t()}}function rt(o,p){if(o&1){let a=j();n(0,"button",65),x("click",function(){y(a);let r=h().index,e=h(2).index,s=h();return C(s.removeGuest(e,r))}),n(1,"i",66),l(2," remove "),t(),l(3," Remove Guest "),t()}}function at(o,p){o&1&&(n(0,"small",44),l(1,"First Name is required"),t())}function ot(o,p){o&1&&(n(0,"small",44),l(1,"Last Name is required"),t())}function mt(o,p){o&1&&(n(0,"small",44),l(1,"Phone is required"),t())}function st(o,p){o&1&&(n(0,"small",44),l(1,"Email is not valid"),t())}function ut(o,p){o&1&&(n(0,"small",44),l(1,"Address Line 1 is required"),t())}function dt(o,p){o&1&&(n(0,"small",44),l(1,"City is required"),t())}function pt(o,p){o&1&&(n(0,"small",44),l(1,"State is required"),t())}function ct(o,p){o&1&&(n(0,"small",44),l(1,"Country is required"),t())}function _t(o,p){o&1&&(n(0,"small",44),l(1,"Zip Code is required"),t())}function vt(o,p){if(o&1){let a=j();n(0,"div"),g(1,"img",45),n(2,"i",46),x("click",function(){let r=y(a).$implicit,e=h().$implicit,s=h(3);return C(s.deletePhotos(r,e))}),l(3," delete "),t()()}if(o&2){let a=p.$implicit;m(),d("src",a,Y)}}function gt(o,p){if(o&1){let a=j();n(0,"div",56)(1,"div",57)(2,"div",8)(3,"div")(4,"label",29),l(5),t()(),n(6,"div")(7,"div",58)(8,"ngx-file-drop",10),x("onFileDrop",function(r){let e=y(a).$implicit,s=h(3);return C(s.dropped(r,e))}),v(9,nt,4,0,"ng-template",11),t(),n(10,"div",59)(11,"input",60),x("click",function(r){let e=y(a).$implicit,s=h(3);return C(s.sameAsCustomer(e,r))}),t(),n(12,"label",61),l(13,"Same as Customer"),t()()()()(),g(14,"hr",12),v(15,lt,4,0,"button",62)(16,rt,4,0,"button",62),t(),n(17,"div",13)(18,"label",14),l(19," First Name "),t(),g(20,"input",15),v(21,at,2,0,"small",16),t(),n(22,"div",13)(23,"label",14),l(24," Last Name"),t(),g(25,"input",17),v(26,ot,2,0,"small",16),t(),n(27,"div",13)(28,"label",14),l(29," Phone"),t(),g(30,"input",63),v(31,mt,2,0,"small",16),t(),n(32,"div",13)(33,"label",14),l(34," Email"),t(),g(35,"input",19),v(36,st,2,0,"small",16),t(),n(37,"div",13)(38,"label",14),l(39,"Address Line 1"),t(),g(40,"input",20),v(41,ut,2,0,"small",16),t(),n(42,"div",13)(43,"label",14),l(44,"Address Line 2"),t(),g(45,"input",21),t(),n(46,"div",13)(47,"label",14),l(48,"City"),t(),g(49,"input",22),v(50,dt,2,0,"small",16),t(),n(51,"div",13)(52,"label",14),l(53,"State"),t(),g(54,"input",23),v(55,pt,2,0,"small",16),t(),n(56,"div",13)(57,"label",14),l(58,"Country"),t(),g(59,"input",24),v(60,ct,2,0,"small",16),t(),n(61,"div",13)(62,"label",14),l(63,"Zip Code"),t(),g(64,"input",25),v(65,_t,2,0,"small",16),t(),n(66,"div",64),v(67,vt,4,1,"div",26),t()()}if(o&2){let a,i,r,e,s,c,_,R,F,I,N,w,D,T,V,k,O,A,L,u=p.$implicit,P=p.index;d("formGroupName",P),m(5),b("Guest Information ",P+1," "),m(10),d("ngIf",P==0),m(),d("ngIf",P>0),m(4),d("ngClass",S(23,E,(((a=u.get("firstName"))==null?null:a.dirty)||((a=u.get("firstName"))==null?null:a.touched))&&((a=u.get("firstName"))==null?null:a.invalid))),m(),d("ngIf",(((i=u.get("firstName"))==null?null:i.dirty)||((i=u.get("firstName"))==null?null:i.touched))&&((i=u.get("firstName"))==null?null:i.invalid)),m(4),d("ngClass",S(25,E,(((r=u.get("lastName"))==null?null:r.dirty)||((r=u.get("lastName"))==null?null:r.touched))&&((r=u.get("lastName"))==null?null:r.invalid))),m(),d("ngIf",(((e=u.get("lastName"))==null?null:e.dirty)||((e=u.get("lastName"))==null?null:e.touched))&&((e=u.get("lastName"))==null?null:e.invalid)),m(4),d("ngClass",S(27,E,(((s=u.get("phone"))==null?null:s.dirty)||((s=u.get("phone"))==null?null:s.touched))&&((s=u.get("phone"))==null?null:s.invalid))),m(),d("ngIf",(((c=u.get("phone"))==null?null:c.dirty)||((c=u.get("phone"))==null?null:c.touched))&&((c=u.get("phone"))==null?null:c.invalid)),m(4),d("ngClass",S(29,E,(((_=u.get("email"))==null?null:_.dirty)||((_=u.get("email"))==null?null:_.touched))&&((_=u.get("email"))==null?null:_.invalid))),m(),d("ngIf",(((R=u.get("email"))==null?null:R.dirty)||((R=u.get("email"))==null?null:R.touched))&&((R=u.get("email"))==null?null:R.invalid)),m(4),d("ngClass",S(31,E,(((F=u.get("addressLine1"))==null?null:F.dirty)||((F=u.get("addressLine1"))==null?null:F.touched))&&((F=u.get("addressLine1"))==null?null:F.invalid))),m(),d("ngIf",(((I=u.get("addressLine1"))==null?null:I.dirty)||((I=u.get("addressLine1"))==null?null:I.touched))&&((I=u.get("addressLine1"))==null?null:I.invalid)),m(8),d("ngClass",S(33,E,(((N=u.get("city"))==null?null:N.dirty)||((N=u.get("city"))==null?null:N.touched))&&((N=u.get("city"))==null?null:N.invalid))),m(),d("ngIf",(((w=u.get("city"))==null?null:w.dirty)||((w=u.get("city"))==null?null:w.touched))&&((w=u.get("city"))==null?null:w.invalid)),m(4),d("ngClass",S(35,E,(((D=u.get("state"))==null?null:D.dirty)||((D=u.get("state"))==null?null:D.touched))&&((D=u.get("state"))==null?null:D.invalid))),m(),d("ngIf",(((T=u.get("state"))==null?null:T.dirty)||((T=u.get("state"))==null?null:T.touched))&&((T=u.get("state"))==null?null:T.invalid)),m(4),d("ngClass",S(37,E,(((V=u.get("country"))==null?null:V.dirty)||((V=u.get("country"))==null?null:V.touched))&&((V=u.get("country"))==null?null:V.invalid))),m(),d("ngIf",(((k=u.get("country"))==null?null:k.dirty)||((k=u.get("country"))==null?null:k.touched))&&((k=u.get("country"))==null?null:k.invalid)),m(4),d("ngClass",S(39,E,(((O=u.get("zipCode"))==null?null:O.dirty)||((O=u.get("zipCode"))==null?null:O.touched))&&((O=u.get("zipCode"))==null?null:O.invalid))),m(),d("ngIf",(((A=u.get("zipCode"))==null?null:A.dirty)||((A=u.get("zipCode"))==null?null:A.touched))&&((A=u.get("zipCode"))==null?null:A.invalid)),m(2),d("ngForOf",(L=u.get("documents"))==null?null:L.value)}}function ft(o,p){if(o&1&&(n(0,"div",4)(1,"div",53)(2,"div",54),v(3,gt,68,41,"div",55),t()()()),o&2){let a=h().$implicit,i=h();m(3),d("ngForOf",i.getGuests(a).controls)}}function ht(o,p){if(o&1&&(n(0,"option",72),l(1),t()),o&2){let a=p.$implicit;d("value",a.id),m(),b(" ",a.roomName," ")}}function yt(o,p){o&1&&(n(0,"option",69),l(1,"assign"),t())}function Ct(o,p){if(o&1){let a=j();n(0,"div",27)(1,"div",28)(2,"label",29),l(3,"Room Details"),t(),n(4,"div",30)(5,"label",14),l(6,"Room:"),t(),n(7,"select",67),v(8,ht,2,2,"option",68)(9,yt,2,0,"option",69),t(),n(10,"label",70),l(11," Room Price : "),n(12,"span",31),l(13),t()(),g(14,"br"),n(15,"label",14),l(16," Room Cost : "),n(17,"a",71),x("click",function(){y(a);let r=h(),e=r.$implicit,s=r.index,c=h(),_=H(107);return C(c.openUpdateRate(_,e==null?null:e.value,s))}),l(18),t()()()()()}if(o&2){let a,i,r,e=h(),s=e.$implicit,c=e.index,_=h();m(8),d("ngForOf",_.filterRooms(_.roomTypeRooms[(a=s.get("roomTypeId"))==null?null:a.value],c)),m(),oe(9,_.isWalkin?-1:9),m(4),b("",s==null||(i=s.get("roomPrice"))==null||i.value==null?null:i.value.toFixed(2)," "),m(5),b(" ",s==null||(r=s.get("roomCost"))==null||r.value==null?null:r.value.toFixed(2)," ")}}function xt(o,p){if(o&1){let a=j();n(0,"div",48)(1,"div",7)(2,"div",49),x("click",function(){let r,e=y(a).$implicit;return C((r=e.get("isDetailsVisiable"))==null?null:r.setValue(!((r=e.get("isDetailsVisiable"))!=null&&r.value)))}),n(3,"h5",29),l(4),t(),n(5,"div")(6,"i",50),l(7," arrow_forward_ios "),t()()(),g(8,"hr",12),t(),v(9,ft,4,1,"div",51)(10,Ct,19,4,"div",52),t()}if(o&2){let a,i,r,e,s=p.$implicit,c=p.index,_=h();d("formGroupName",c),m(4),me(" ",_.isWalkin?"Walk In":"Reservation"," Details of ( ",s==null||(a=s.get("roomtype"))==null?null:a.value,"- ",s==null||(a=s.get("rateName"))==null?null:a.value,") ","Adults/Childs:"+((a=s.get("adultOccupant"))==null?null:a.value)+"/"+((a=s.get("adultOccupant"))==null?null:a.value)," ",((a=s.get("extraAdults"))==null?null:a.value)>0||((a=s.get("extraChilds"))==null?null:a.value)>0?"Extra Adults/Childs:"+((a=s.get("extraAdults"))==null?null:a.value)+"/"+((a=s.get("extraChilds"))==null?null:a.value):""," "),m(2),ae((i=s.get("isDetailsVisiable"))!=null&&i.value?"    rotate: 270deg;":"    rotate: 90deg;"),m(3),d("ngIf",(r=s.get("isDetailsVisiable"))==null?null:r.value),m(),d("ngIf",(e=s.get("isDetailsVisiable"))==null?null:e.value)}}function St(o,p){if(o&1&&(n(0,"tr")(1,"th",78),l(2),ce(3,"date"),t(),n(4,"td",80),l(5),t()()),o&2){let a=p.$implicit;m(2),q(_e(3,2,a.date)),m(3),b(" ",a.baseRate," ")}}function Et(o,p){if(o&1&&(n(0,"tr")(1,"td"),l(2,"Extra Adults"),t(),n(3,"td",80),l(4),t(),n(5,"td",80),l(6),t()()),o&2){let a=h(2);m(4),b(" ",a.updateDateRateObj.extraAdults+"*"+a.updateDateRateObj.dateRate[0].adultRate+"*"+a.updateDateRateObj.dateRate.length+" Night"," "),m(2),b(" ",a.updateDateRateObj.extraAdults*a.updateDateRateObj.dateRate[0].adultRate*a.updateDateRateObj.dateRate.length," ")}}function bt(o,p){if(o&1&&(n(0,"tr")(1,"td"),l(2,"Extra Childs"),t(),n(3,"td",80),l(4),t(),n(5,"td",80),l(6),t()()),o&2){let a=h(2);m(4),b(" ",a.updateDateRateObj.extraChilds+"*"+a.updateDateRateObj.dateRate[0].childRate+"*"+a.updateDateRateObj.dateRate.length+" Night"," "),m(2),b(" ",a.updateDateRateObj.extraChilds*a.updateDateRateObj.dateRate[0].childRate*a.updateDateRateObj.dateRate.length," ")}}function Rt(o,p){if(o&1){let a=j();n(0,"div",73)(1,"h4",74),l(2,"Rate Update"),t(),n(3,"button",75,2),x("click",function(){let r=y(a).$implicit;return C(r.close(!1))}),t()(),n(5,"div",76)(6,"table",77)(7,"thead")(8,"tr")(9,"th",78),l(10,"DATE"),t(),n(11,"th"),l(12,"ESTIMATED COST"),t()()(),n(13,"tbody"),v(14,St,6,4,"tr",26)(15,Et,7,2,"tr",79)(16,bt,7,2,"tr",79),n(17,"tr")(18,"td",78),l(19),t(),n(20,"td",80),l(21),t()(),n(22,"tr",81)(23,"td",80),l(24),t(),n(25,"td"),l(26,"Total Cost"),t(),n(27,"td",80)(28,"input",82),de("ngModelChange",function(r){y(a);let e=h();return ue(e.updateDateRateObj.roomCost,r)||(e.updateDateRateObj.roomCost=r),C(r)}),t()()()()(),n(29,"div",83)(30,"button",84),x("click",function(){y(a);let r=h();return C(r.calculateRate())}),l(31," Calculate "),t(),n(32,"button",85),x("click",function(){let r=y(a).$implicit;return C(r.close(!0))}),l(33,"Save"),t(),n(34,"button",86),x("click",function(){let r=y(a).$implicit;return C(r.close(!1))}),l(35," cancel "),t()()()}if(o&2){let a=h();m(14),d("ngForOf",a.updateDateRateObj.dateRate),m(),d("ngIf",a.updateDateRateObj.extraAdults>0),m(),d("ngIf",a.updateDateRateObj.extraChilds),m(3),b(" Tax Summary(",a.updateDateRateObj.taxPercentage+" %",") "),m(2),b(" ",a.updateDateRateObj.taxPercentage*a.updateDateRateObj.roomPrice/100," "),m(3),b(" Total Price ",a.updateDateRateObj.roomPrice," "),m(4),se("ngModel",a.updateDateRateObj.roomCost)}}function Ft(o,p){if(o&1){let a=j();n(0,"div",76)(1,"h6",74),l(2," Are you sure want to countinue without payment ? "),t()(),n(3,"div",87)(4,"button",88),x("click",function(){y(a);let r=h();return C(r.goToPayment())}),l(5," Go to Payment "),t(),n(6,"button",89),x("click",function(){let r=y(a).$implicit;return C(r.close(!1))}),l(7," No "),t(),n(8,"button",88),x("click",function(){let r=y(a).$implicit;return C(r.close(!0))}),l(9," Yes "),t()()}}var qt=(()=>{let p=class p{constructor(i,r,e,s,c,_,R,F){this.fb=i,this.modalService=r,this.crudService=e,this.alertService=s,this.authService=c,this.activeRoute=_,this.router=R,this.route=F,this.propertyUnitId="",this.roomsData=[],this.updateDateRateObj={},this.isWalkin=!1,this.files=[]}ngOnInit(){this.propertyUnitId=this.authService.getUserInfo()?.user?.propertyUnitId,this.isWalkin=this.router.url!="/reservation-info",this.initializeForms(),this.loadData()}initializeForms(){this.reservationForm=this.fb.group({reservations:this.fb.array([])}),this.groupForm=this.fb.group({arrival:[this.formatDate(new Date),f.required],departure:[this.formatDate(new Date),f.required],adults:[2,[f.min(1),f.required]],childs:[0,f.required],totalCost:[0],totalPrice:[0],firstName:["",[f.required,f.minLength(2)]],lastName:["",[f.required,f.minLength(2)]],email:["",[f.email]],phone:[""],addressLine1:[""],addressLine2:[""],country:[""],city:[""],state:["",[f.pattern(/^[A-Za-z\s]+$/)]],zipCode:[""],documents:[]})}loadData(){let i=sessionStorage.getItem("resdata");if(i){let s=JSON.parse(i);this.groupForm.patchValue(s.groupDetails),this.populateReservations(s.reservationDetails),this.roomTypeRooms=s.roomTypeRooms}let r=sessionStorage.getItem("reservationsArray");if(r){let s=JSON.parse(r);this.reservations.clear(),s.forEach(c=>{this.reservations.push(this.createReservation(c))})}let e=sessionStorage.getItem("groupDetails");if(e){let s=JSON.parse(e);this.groupForm.patchValue(s)}}formatDate(i){return new W("en-US").transform(i,"yyyy-MM-dd")}createReservation(i){return this.fb.group({roomTypeId:[i?.roomTypeId||"",f.required],roomId:[i?.roomId||"",f.required],rateplanId:[i?.rateplanId||"",f.required],rateName:[i?.rateName||"",f.required],roomtype:[i?.roomtype||"",f.required],adultOccupant:[i?.adultOccupant||0,f.required],childOccupant:[i?.childOccupant||0],extraAdults:[i?.extraAdults||0],extraChilds:[i?.extraChilds||0],taxPercentage:[i?.taxPercentage||0],roomPrice:[i?.roomPrice||0,f.required],roomCost:[i?.roomCost||0,f.required],images:[i?.images||[]],dateRate:this.fb.array(i?this.createDateRates(i.dateRate):[this.createDateRate()]),guests:this.fb.array(i?.guests?this.createGuests(i.guests):[this.createGuest()]),isDetailsVisiable:[!0]})}createDateRates(i){return i.map(r=>this.createDateRate(r))}createDateRate(i){return this.fb.group({date:[i?.date||"",f.required],baseRate:[i?.baseRate||"",f.required],adultRate:[i?.adultRate||"",f.required],childRate:[i?.childRate||"",f.required]})}createGuests(i){return i.map(r=>this.createGuest(r))}createGuest(i){return this.fb.group({firstName:[i?.firstName||"",f.required],lastName:[i?.lastName||"",f.required],email:[i?.email||"",[f.email]],phone:[i?.phone||""],addressLine1:[i?.addressLine1||""],addressLine2:[i?.addressLine2||""],country:[i?.country||""],city:[i?.city||""],state:[i?.state||""],zipCode:[i?.zipCode||""],isSameAsCustomer:[!1],documents:[]})}populateReservations(i){let r=this.reservationForm.get("reservations");i.forEach(e=>r.push(this.createReservation(e)))}get reservations(){return this.reservationForm.get("reservations")}addReservation(){this.reservations.push(this.createReservation())}getDateRates(i){return i.get("dateRate")}getGuests(i){return i.get("guests")}addGuest(i){this.getGuests(this.reservations.at(i)).push(this.createGuest())}removeGuest(i,r){let e=this.getGuests(this.reservations.at(i));e.length>1&&e.removeAt(r)}sameAsCustomer(i,r){r.target.checked&&i.patchValue(this.groupForm.value)}filterRooms(i,r){return this.reservationForm.get("reservations")?.value.forEach((e,s)=>{r!=s&&(i=i.filter(c=>c.id!=e.roomId))}),i}openUpdateRate(i,r,e){this.updateDateRateObj=J({},r),this.modalService.open(i).result.then(s=>{if(s){let c=this.reservations.at(e).value;this.reservations.at(e).patchValue(this.updateDateRateObj),this.groupForm.controls.totalCost.patchValue(this.groupForm.controls.totalCost.value-c.roomCost+this.updateDateRateObj.roomCost),this.groupForm.controls.totalPrice.patchValue(this.groupForm.controls.totalPrice.value-c.roomPrice+this.updateDateRateObj.roomPrice)}})}calculateRate(){this.updateDateRateObj.roomPrice=Math.round(this.updateDateRateObj.roomCost/1.11*100)/100;let i=Math.round(this.updateDateRateObj.roomPrice/this.updateDateRateObj.dateRate.length*100)/100;this.updateDateRateObj.dateRate.forEach(r=>{r.baseRate=i})}goToPayment(){sessionStorage.setItem("reservationsArray",JSON.stringify(this.reservationForm.get("reservations")?.value)),sessionStorage.setItem("groupDetails",JSON.stringify(this.groupForm.value)),this.isWalkin?this.router.navigate(["/walkin-payment"]):this.router.navigate(["/reservation-payment"]),this.modalService.dismissAll()}onReserve(i){this.modalService.open(i).result.then(r=>{if(r){let e={propertyUnitId:this.propertyUnitId,reservationsArray:this.reservationForm.get("reservations")?.value,groupDetails:le(J({},this.groupForm.value),{totalTax:this.groupForm.get("totalCost")?.value-this.groupForm.get("totalPrice")?.value,totalBalance:-this.groupForm.get("totalCost")?.value,totalPayment:0,totalDeposit:0}),isWalkin:this.isWalkin};this.crudService.post(U.CREATE_RESERVATION,e).then(s=>{console.log(s),this.alertService.successAlert(`${this.isWalkin?"Walkin":"Reservation"} created successfully`),this.router.navigate(["/guest-folio/"+s?.data?._id])}).catch(s=>{this.alertService.errorAlert(s?.error?.message||"An error occurred"),console.error(s)})}})}dropped(i,r){this.files=i;let e=new FormData;for(let s of i)if(s.fileEntry.isFile)s.fileEntry.file(_=>{this.validateImageFile(_)?e.append("uploadedImages",_,s.relativePath):this.alertService.errorAlert(`Invalid file: ${_.name}. Only image files under 3 MB are allowed.`),i.indexOf(s)===i.length-1&&(e.has("uploadedImages")?this.uploadPhotos(e,r):this.alertService.errorAlert("No valid image files to upload."))});else{let c=s.fileEntry;console.log(s.relativePath,c)}}validateImageFile(i){return["image/jpeg","image/png","image/gif","image/webp"].includes(i.type)&&i.size<=3145728}uploadPhotos(i,r){this.crudService.post(U.UPLOAD_RESERVATION_IMAGES,i).then(e=>{if(console.log(e),e?.data?.images?.length){let s=r.get("documents")?.value?r.get("documents")?.value:[];r.patchValue({documents:[...s,...e?.data?.images]})}}).catch(e=>{this.alertService.errorAlert(e?.error?.message||"An error occurred"),console.error(e)})}deletePhotos(i,r){this.crudService.post(U.DELETE_RESERVATION_IMAGES,{imageUrl:i}).then(e=>{let c=(r.get("documents")?.value?r.get("documents")?.value:[]).filter(_=>_!==i);r.patchValue({documents:c})}).catch(e=>{this.alertService.errorAlert(e?.error?.message||"An error occurred "),console.error(e)})}fileOver(i){console.log(i)}fileLeave(i){console.log(i)}};p.\u0275fac=function(r){return new(r||p)(G(Le),G(ze),G(Ce),G(xe),G(Se),G(Q),G(ye),G(Q))},p.\u0275cmp=re({type:p,selectors:[["app-reservation-info"]],standalone:!0,features:[pe],decls:110,vars:53,consts:[["RateUpdate",""],["confirmReservation",""],["closeButton",""],[1,"m-3","row","g-0"],[1,"col-9"],[1,"container_form","p-3","m-2","rounded",3,"formGroup"],[1,"row","row-cols-1","row-cols-md-2"],[1,"col-md-12"],[1,"d-flex","justify-content-between"],[1,"form-label","fs-3","fw-semibold"],["dropZoneClassName","my-style","contentClassName","my-style",3,"onFileDrop"],["ngx-file-drop-content-tmp",""],[1,"m-0"],[1,"col","mt-3"],[1,"form-label"],["type","text","formControlName","firstName","placeholder","Enter  First Name",1,"form-control",3,"ngClass"],["class","text-danger",4,"ngIf"],["type","text","formControlName","lastName","placeholder","Enter  Last Name",1,"form-control",3,"ngClass"],["type","tel","formControlName","phone","placeholder","Enter  Phone","maxlength","10",1,"form-control",3,"ngClass"],["type","text","formControlName","email","placeholder","Enter  Email",1,"form-control",3,"ngClass"],["type","text","formControlName","addressLine1","placeholder","Enter Address Line 1",1,"form-control",3,"ngClass"],["type","text","formControlName","addressLine2","placeholder","Enter Address Line 2",1,"form-control"],["type","text","formControlName","city","placeholder","Enter City",1,"form-control",3,"ngClass"],["type","text","formControlName","state","placeholder","Enter State",1,"form-control",3,"ngClass"],["type","text","formControlName","country","placeholder","Enter Country",1,"form-control",3,"ngClass"],["type","text","formControlName","zipCode","placeholder","Enter Zip Code",1,"form-control",3,"ngClass"],[4,"ngFor","ngForOf"],[1,"col-3"],[1,"card","container_form","p-3","m-2","rounded"],[1,"form-label","fw-semibold"],[1,"card-body"],[1,"fw-semibold"],[3,"formGroup"],["formArrayName","reservations",1,"list-group","list-group-flush"],["class","list-group-item",3,"formGroupName",4,"ngFor","ngForOf"],[1,"form-label","w-100"],[1,"",3,"formGroup"],["formArrayName","reservations"],["class","m-3 row g-0",3,"formGroupName",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center","mb-2"],[1,"btn","btn-primary","mt-2","me-2",3,"click","disabled"],[1,"btn","btn-primary","mt-2","ms-2",3,"click","disabled"],[1,"card-link",2,"cursor","pointer",3,"click"],[1,"material-symbols-rounded",2,"vertical-align","middle","font-size","20px"],[1,"text-danger"],["alt","img",2,"height","100px","width","100px",3,"src"],[1,"material-symbols-rounded","text-danger","pt-2",2,"vertical-align","middle","cursor","pointer",3,"click"],[1,"list-group-item",3,"formGroupName"],[1,"m-3","row","g-0",3,"formGroupName"],[1,"d-flex","justify-content-between","container_form","p-3","m-2","rounded",2,"cursor","pointer",3,"click"],[1,"material-symbols-rounded","ms-2",2,"vertical-align","middle","cursor","pointer"],["class","col-9",4,"ngIf"],["class","col-3",4,"ngIf"],[1,"row","row-cols-1","row-cols-md-2","container_form","p-3","m-2","rounded"],["formArrayName","guests",1,"col-md-12"],["class","row row-cols-1 row-cols-md-2",3,"formGroupName",4,"ngFor","ngForOf"],[1,"row","row-cols-1","row-cols-md-2",3,"formGroupName"],[1,"col-md-12","mt-2"],[1,"d-flex","ms-2"],[1,"form-check","ms-2"],["type","checkbox","formControlName","isSameAsCustomer",1,"form-check-input",3,"click"],[1,"form-check-label"],["class","btn btn-primary mt-2",3,"click",4,"ngIf"],["type","text","formControlName","phone","placeholder","Enter  Phone","maxlength","10",1,"form-control",3,"ngClass"],[1,"col","d-flex","mt-3"],[1,"btn","btn-primary","mt-2",3,"click"],[1,"material-symbols-rounded",2,"vertical-align","middle"],["formControlName","roomId",1,"form-control",2,"appearance","auto"],[3,"value",4,"ngFor","ngForOf"],["value","assign"],[1,"form-label","mt-2"],[1,"link",3,"click"],[3,"value"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"table"],["colspan","2"],[4,"ngIf"],[1,"text-center"],[2,"vertical-align","middle"],["type","number",1,"form-control","custom_input","text_center","rate_input",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-end","pb-3"],[1,"btn","btn-primary","me-2",3,"click"],[1,"btn","btn-primary",3,"click"],[1,"btn","light_button","button","ml-2",3,"click"],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(r,e){if(r&1){let s=j();n(0,"div",3)(1,"div",4)(2,"form",5)(3,"div",6)(4,"div",7)(5,"div",8)(6,"p",9),l(7,"Customer Details"),t(),n(8,"ngx-file-drop",10),x("onFileDrop",function(_){return y(s),C(e.dropped(_,e.groupForm))}),v(9,Ue,4,0,"ng-template",11),t()(),g(10,"hr",12),t(),n(11,"div",13)(12,"label",14),l(13," First Name"),t(),g(14,"input",15),v(15,Be,2,0,"small",16),t(),n(16,"div",13)(17,"label",14),l(18," Last Name"),t(),g(19,"input",17),v(20,Ze,2,0,"small",16),t(),n(21,"div",13)(22,"label",14),l(23," Phone"),t(),g(24,"input",18),v(25,Je,2,0,"small",16),t(),n(26,"div",13)(27,"label",14),l(28," Email"),t(),g(29,"input",19),v(30,Ye,2,0,"small",16),t(),n(31,"div",13)(32,"label",14),l(33,"Address Line 1"),t(),g(34,"input",20),v(35,He,2,0,"small",16),t(),n(36,"div",13)(37,"label",14),l(38,"Address Line 2"),t(),g(39,"input",21),t(),n(40,"div",13)(41,"label",14),l(42,"City"),t(),g(43,"input",22),v(44,Ke,2,0,"small",16),t(),n(45,"div",13)(46,"label",14),l(47,"State"),t(),g(48,"input",23),v(49,Qe,2,0,"small",16),t(),n(50,"div",13)(51,"label",14),l(52,"Country"),t(),g(53,"input",24),v(54,Xe,2,0,"small",16),t(),n(55,"div",13)(56,"label",14),l(57,"Zip Code"),t(),g(58,"input",25),v(59,et,2,0,"small",16),t(),n(60,"div",13),v(61,tt,4,1,"div",26),t()()()(),n(62,"div",27)(63,"div",28)(64,"label",29),l(65),t(),n(66,"div",30)(67,"label",14),l(68," CheckIn Date : "),n(69,"span",31),l(70),t()(),n(71,"label",14),l(72," CheckOut Date : "),n(73,"span",31),l(74),t()(),n(75,"label",14),l(76," Adults: "),n(77,"span",31),l(78),t(),l(79," Childs: "),n(80,"span",31),l(81),t()()(),n(82,"form",32)(83,"ul",33),v(84,it,6,3,"li",34),t()(),n(85,"div",30)(86,"label",35),l(87," Total Price : "),n(88,"span",31),l(89),t()(),n(90,"label",35),l(91," Total Tax : "),n(92,"span",31),l(93),t()(),n(94,"label",14),l(95," Total Cost : "),n(96,"span",31),l(97),t()()()()()(),n(98,"form",36)(99,"div",37),v(100,xt,11,10,"div",38),t()(),n(101,"div",39)(102,"button",40),x("click",function(){y(s);let _=H(109);return C(e.onReserve(_))}),l(103),t(),n(104,"button",41),x("click",function(){return y(s),C(e.goToPayment())}),l(105," Payment "),t()(),v(106,Rt,36,7,"ng-template",null,0,K)(108,Ft,10,0,"ng-template",null,1,K)}if(r&2){let s,c,_,R,F,I,N,w,D,T,V,k,O,A,L,u,P,z,X,ee,te,ie,ne,B,M,$,Z;m(2),d("formGroup",e.groupForm),m(12),d("ngClass",S(35,E,(((s=e.groupForm.get("firstName"))==null?null:s.dirty)||((s=e.groupForm.get("firstName"))==null?null:s.touched))&&((s=e.groupForm.get("firstName"))==null?null:s.invalid))),m(),d("ngIf",(((c=e.groupForm.get("firstName"))==null?null:c.dirty)||((c=e.groupForm.get("firstName"))==null?null:c.touched))&&((c=e.groupForm.get("firstName"))==null?null:c.invalid)),m(4),d("ngClass",S(37,E,(((_=e.groupForm.get("lastName"))==null?null:_.dirty)||((_=e.groupForm.get("lastName"))==null?null:_.touched))&&((_=e.groupForm.get("lastName"))==null?null:_.invalid))),m(),d("ngIf",(((R=e.groupForm.get("lastName"))==null?null:R.dirty)||((R=e.groupForm.get("lastName"))==null?null:R.touched))&&((R=e.groupForm.get("lastName"))==null?null:R.invalid)),m(4),d("ngClass",S(39,E,(((F=e.groupForm.get("phone"))==null?null:F.dirty)||((F=e.groupForm.get("phone"))==null?null:F.touched))&&((F=e.groupForm.get("phone"))==null?null:F.invalid))),m(),d("ngIf",(((I=e.groupForm.get("phone"))==null?null:I.dirty)||((I=e.groupForm.get("phone"))==null?null:I.touched))&&((I=e.groupForm.get("phone"))==null?null:I.invalid)),m(4),d("ngClass",S(41,E,(((N=e.groupForm.get("email"))==null?null:N.dirty)||((N=e.groupForm.get("email"))==null?null:N.touched))&&((N=e.groupForm.get("email"))==null?null:N.invalid))),m(),d("ngIf",(((w=e.groupForm.get("email"))==null?null:w.dirty)||((w=e.groupForm.get("email"))==null?null:w.touched))&&((w=e.groupForm.get("email"))==null?null:w.invalid)),m(4),d("ngClass",S(43,E,(((D=e.groupForm.get("addressLine1"))==null?null:D.dirty)||((D=e.groupForm.get("addressLine1"))==null?null:D.touched))&&((D=e.groupForm.get("addressLine1"))==null?null:D.invalid))),m(),d("ngIf",(((T=e.groupForm.get("addressLine1"))==null?null:T.dirty)||((T=e.groupForm.get("addressLine1"))==null?null:T.touched))&&((T=e.groupForm.get("addressLine1"))==null?null:T.invalid)),m(8),d("ngClass",S(45,E,(((V=e.groupForm.get("city"))==null?null:V.dirty)||((V=e.groupForm.get("city"))==null?null:V.touched))&&((V=e.groupForm.get("city"))==null?null:V.invalid))),m(),d("ngIf",(((k=e.groupForm.get("city"))==null?null:k.dirty)||((k=e.groupForm.get("city"))==null?null:k.touched))&&((k=e.groupForm.get("city"))==null?null:k.invalid)),m(4),d("ngClass",S(47,E,(((O=e.groupForm.get("state"))==null?null:O.dirty)||((O=e.groupForm.get("state"))==null?null:O.touched))&&((O=e.groupForm.get("state"))==null?null:O.invalid))),m(),d("ngIf",(((A=e.groupForm.get("state"))==null?null:A.dirty)||((A=e.groupForm.get("state"))==null?null:A.touched))&&((A=e.groupForm.get("state"))==null?null:A.invalid)),m(4),d("ngClass",S(49,E,(((L=e.groupForm.get("country"))==null?null:L.dirty)||((L=e.groupForm.get("country"))==null?null:L.touched))&&((L=e.groupForm.get("country"))==null?null:L.invalid))),m(),d("ngIf",(((u=e.groupForm.get("country"))==null?null:u.dirty)||((u=e.groupForm.get("country"))==null?null:u.touched))&&((u=e.groupForm.get("country"))==null?null:u.invalid)),m(4),d("ngClass",S(51,E,(((P=e.groupForm.get("zipCode"))==null?null:P.dirty)||((P=e.groupForm.get("zipCode"))==null?null:P.touched))&&((P=e.groupForm.get("zipCode"))==null?null:P.invalid))),m(),d("ngIf",(((z=e.groupForm.get("zipCode"))==null?null:z.dirty)||((z=e.groupForm.get("zipCode"))==null?null:z.touched))&&((z=e.groupForm.get("zipCode"))==null?null:z.invalid)),m(2),d("ngForOf",(X=e.groupForm.get("documents"))==null?null:X.value),m(4),b(" ",e.isWalkin?"Walk In":"Reservation"," Summary"),m(5),q((ee=e.groupForm.get("arrival"))==null?null:ee.value),m(4),q((te=e.groupForm.get("departure"))==null?null:te.value),m(4),q((ie=e.groupForm.get("adults"))==null?null:ie.value),m(3),q((ne=e.groupForm.get("childs"))==null?null:ne.value),m(),d("formGroup",e.reservationForm),m(2),d("ngForOf",e.reservations.controls),m(5),q((B=e.groupForm.get("totalPrice"))==null||B.value==null?null:B.value.toFixed(2)),m(4),q((((M=e.groupForm.get("totalCost"))==null?null:M.value)||0-(($=e.groupForm.get("totalPrice"))==null?null:$.value)||0)==null?null:(((M=M)==null?null:M.value)||0-(($=$)==null?null:$.value)||0).toFixed(2)),m(4),q((Z=e.groupForm.get("totalCost"))==null||Z.value==null?null:Z.value.toFixed(2)),m(),d("formGroup",e.reservationForm),m(2),d("ngForOf",e.reservations.controls),m(2),d("disabled",e.groupForm.invalid||e.reservationForm.invalid),m(),b(" ",e.isWalkin?"Check In":"Reserve"," "),m(),d("disabled",e.groupForm.invalid||e.reservationForm.invalid)}},dependencies:[Ge,Ne,Ae,je,be,we,Ee,Oe,Re,Fe,Pe,Ie,qe,De,ke,Te,Ve,he,ve,ge,fe,W,We,$e,Me]});let o=p;return o})();export{qt as ReservationInfoComponent};

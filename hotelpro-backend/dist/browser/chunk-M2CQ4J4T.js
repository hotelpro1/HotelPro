import{a as lt,b as ct}from"./chunk-MSM33I7I.js";import{d as at}from"./chunk-6N4QSK7X.js";import{c as X,e as Z,j as tt,l as et,u as nt,x as it,y as ot,z as rt}from"./chunk-DKI4PBNW.js";import{b as Q}from"./chunk-3FS5RTN6.js";import{Aa as x,Ca as S,Da as p,Db as V,Fb as G,Jb as Y,Kb as q,L as A,Ma as m,Mb as J,Na as y,Nb as K,Oa as w,T as O,Ta as D,U as P,Ua as b,Va as T,Xa as L,Za as k,bb as U,db as z,ea as d,fa as f,la as u,na as _,nb as j,oa as F,ob as $,pb as B,qa as R,ra as W,tb as v,wa as a,wb as H,xa as l,ya as M,za as C}from"./chunk-W7CJDNGE.js";var dt=i=>({clean_active:i}),st=i=>({dirty_active:i});function mt(i,s){if(i&1&&(a(0,"th",36),m(1),U(2,"date"),M(3,"br"),l()),i&2){let o=s.$implicit;d(),w(" ",z(2,1,o,"dd MMM")," ")}}function pt(i,s){if(i&1&&(a(0,"div")(1,"div",19)(2,"div",45)(3,"div",46),m(4),l()()()()),i&2){let o=p(2).$implicit,t=p(5);R("width:"+t.nightNumber(o.arrival,o.departure)*100+"px;"),W(""+t.setBackground(o)),d(4),w(" ",o.guestName," ")}}function _t(i,s){if(i&1&&(C(0),u(1,pt,5,5,"div",44),x()),i&2){let o=p().$implicit,t=p().$implicit,n=p(4);d(),_("ngIf",n.test(t,o))}}function gt(i,s){if(i&1&&(C(0),u(1,_t,2,1,"ng-container",37),x()),i&2){let o=s.$implicit,t=p().$implicit;d(),_("ngIf",o.arrival<=t&&o.departure>t&&!o.tentative)}}function ht(i,s){if(i&1&&(a(0,"div",48)(1,"div",49)(2,"div",50)(3,"div",51),m(4),l()()()()),i&2){let o=p(2).$implicit,t=p(5);F("width",t.nightNumber(o.startDate,o.endDate)*100+"px"),d(4),y(o.reason)}}function ut(i,s){if(i&1&&(C(0),u(1,ht,5,3,"div",47),x()),i&2){let o=p().$implicit,t=p().$implicit,n=p(4);d(),_("ngIf",n.testmaintainance(t,o))}}function ft(i,s){if(i&1&&(C(0),u(1,ut,2,1,"ng-container",37),x()),i&2){let o=s.$implicit,t=p().$implicit;d(),_("ngIf",o.startDate<=t&&o.endDate>=t)}}function Ct(i,s){if(i&1&&(a(0,"td")(1,"div",41)(2,"div",42)(3,"div"),m(4),l()(),a(5,"div",43),u(6,gt,2,1,"ng-container",35)(7,ft,2,1,"ng-container",35),l()()()),i&2){let o=s.index,t=p(2).$implicit,n=p().$implicit;d(4),w(" ",n.dailyRates==null||n.dailyRates[o]==null?null:n.dailyRates[o].baseRate," "),d(2),_("ngForOf",t.reservation),d(),_("ngForOf",t.maintenance)}}function xt(i,s){if(i&1&&(a(0,"tr")(1,"td",36),m(2),l(),a(3,"td",36),m(4),l(),a(5,"td",36)(6,"div",38)(7,"div",39),m(8," Clean "),l(),a(9,"div",40),m(10," Dirty "),l()()(),u(11,Ct,8,3,"td",35),l()),i&2){let o=p().$implicit,t=p().$implicit,n=p();d(2),y(t.roomTypeName),d(2),y(o.roomName),d(3),_("ngClass",k(5,dt,o.roomCondition=="clean")),d(2),_("ngClass",k(7,st,o.roomCondition=="dirty")),d(2),_("ngForOf",n.DateArr)}}function vt(i,s){if(i&1&&(C(0),u(1,xt,12,9,"tr",37),x()),i&2){let o=p().$implicit;d(),_("ngIf",o.Show)}}function St(i,s){if(i&1&&(C(0),u(1,vt,2,1,"ng-container",35),x()),i&2){let o=s.$implicit;d(),_("ngForOf",o.roomDetails)}}var Rt=(()=>{let s=class s{constructor(t,n,e,r,c,h,g){this.crudService=t,this.fb=n,this.alertService=e,this.router=r,this.activeRoute=c,this.modalService=h,this.authService=g,this.propertyUnitId="",this.Week=2,this.dropdownList=[],this.selectedItems=[]}ngOnInit(){this.propertyUnitId=this.authService.getUserInfo()?.user?.propertyUnitId,this.Max=new v("en-US").transform(new Date,"yyyy-MM-dd"),this.Date=new v("en-US").transform(new Date,"yyyy-MM-dd"),this.Today=new v("en-US").transform(new Date,"yyyy-MM-dd"),this.dropdownSettings={singleSelection:!1,idField:"item_id",textField:"item_text",unSelectAllText:"UnSelect All",enableCheckAll:!1,itemsShowLimit:2,allowSearchFilter:!0},this.fetchdata()}fetchdata(){if(this.Week<2&&(this.Week=2),this.Week>52&&(this.Week=52),new Date(this.Date).toISOString()<new Date(this.Today).toISOString()){this.Date=this.Today,this.alertService.errorAlert("You can not visit past data");return}this.startDate=new Date(this.Date.replace(/-/g,"/")),this.endDate=new Date(this.startDate),this.endDate.setDate(this.endDate.getDate()+this.Week*7),this.DateArr=[];for(let e=new Date(this.startDate);e<new Date(this.endDate);e.setDate(e.getDate()+1))this.DateArr.push(new Date(e));let t=this.startDate.toLocaleDateString("en-CA"),n=this.endDate.toLocaleDateString("en-CA");this.crudService.post(q.READ_TAPECHART,{startDate:t,endDate:n,propertyUnitId:this.propertyUnitId}).then(e=>{this.dropdownList=[],this.RoomData=this.roomSort(e.data);for(let r of this.RoomData){for(let c of r.roomDetails){for(let h of c.reservation)h.arrival=new Date(h.arrival.split("T")[0].replace(/-/g,"/")+" 00:00"),h.departure=new Date(h.departure.split("T")[0].replace(/-/g,"/")+" 00:00");for(let h of c.maintenance)h.startDate=new Date(h.startDate.split("T")[0].replace(/-/g,"/")+" 00:00"),h.endDate=new Date(h.endDate.split("T")[0].replace(/-/g,"/")+" 00:00")}this.dropdownList.includes(r.roomTypeName)||this.dropdownList.push(r.roomTypeName),r.Show=!0}this.dropdownList=this.dropdownList.map(r=>({item_id:r,item_text:r}))}).catch(e=>{this.alertService.errorAlert(e.statusMessage)})}roomSort(t){return t.sort((n,e)=>n.roomTypeName<e.roomTypeName?-1:n.roomTypeName>e.roomTypeName?1:0),t.map(n=>{n.roomDetails.sort((e,r)=>e.roomName<r.roomName?-1:e.roomName>r.roomName?1:0)}),t}setBackground(t){return t.reservationStatus=="reserved"?"reservation":t.reservationStatus=="inhouse"?"inhouse":t.reservationStatus=="checkedout"?"checkedout":""}add(){this.Week+=1}sub(){this.Week>2&&(this.Week-=1)}test(t,n){return t.toString()==n.arrival.toString()||n.arrival<=this.startDate&&t.toString()==this.startDate.toString()}testmaintainance(t,n){return console.log(t.toString(),n.startDate.toString(),t.toString()==n.startDate.toString()),t.toString()==n.startDate.toString()||n.startDate<=this.startDate&&t.toString()==this.startDate.toString()}nightNumber(t,n){let e=new Date(t),r=new Date(n),c=new Date(this.endDate),h=new Date(this.startDate);h.setUTCHours(0,0,0,0),c.setUTCHours(0,0,0,0),e.setUTCHours(0,0,0,0),r.setUTCHours(0,0,0,0);let g=0;if(e<h){r>c&&(g=Math.abs(r.getTime()-c.getTime()),g=Math.round(g/(24*60*60*1e3)),g+=.3),r.toString()==c.toString()&&(g=.3);let E=(h.getTime()-e.getTime())/(24*60*60*1e3),N=(r.getTime()-e.getTime())/(24*60*60*1e3);return N-E-g>=1?N-E-g:.7}r>c&&(g=Math.abs(r.getTime()-c.getTime()),g=Math.round(g/(1e3*3600*24)),g+=.3),r.toString()==c.toString()&&(g=.3);let I=Math.round((r.getTime()-e.getTime())/(1e3*3600*24));return I-g>=1?I-g:.7}filterRoom(){let t=this.selectedItems.map(n=>n.item_id);if(t.length>0)for(let n of this.RoomData)t.includes(n.roomTypeName)?n.Show=!0:n.Show=!1;else for(let n of this.RoomData)n.Show=!0}};s.\u0275fac=function(n){return new(n||s)(f(J),f(it),f(K),f(G),f(V),f(at),f(Q))},s.\u0275cmp=A({type:s,selectors:[["app-tape-chart"]],standalone:!0,features:[L],decls:56,vars:10,consts:[[1,"p-2",2,"background-color","#f1f8ff"],[1,"mx-3","d-flex","mt-2","bg-white"],[1,"w-100","d-flex","mx-3","justify-content-between"],[1,"d-flex","my-2","align-items-center"],[1,"black_font"],[1,"ms-2"],["type","date",1,"form-control",3,"ngModelChange","ngModel","min"],[1,"black_font","align-items-center","ms-3"],[1,"input_container","ms-2"],["type","number",1,"input","form-control","field","text-center","hide-spinner",3,"ngModelChange","ngModel","min"],[1,"input_img",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","20","height","22","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-plus-circle"],["d","M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"],["d","M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"],[1,"input_img1",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","20","height","22","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-dash-circle"],["d","M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8"],[1,"ms-3"],[1,"btn","btn-success","button","w-auto",3,"click"],[1,"d-flex"],[1,"d-flex","ms-2","align-items-center"],[1,"ms-2","align-self-center",2,"width","200px !important"],["name","roomtype",2,"font-size","13px !important","background","white !important",3,"ngModelChange","onSelect","onDeSelect","placeholder","settings","data","ngModel"],[1,"d-flex","justify-content-right","ms-4"],[1,"align-self-center","d-flex"],[1,"reservation","px-2"],[1,"inhouse","px-2","mt-1"],[1,"checkedout","px-2"],[1,"renovation","px-2","mt-1"],[1,"mx-3","mt-2","inline2"],[1,"col-12","pl-0"],["id","scroll",2,"overflow-x","auto","border-right","1px solid rgba(0, 0, 0, 0.1)","max-height","70vh !important"],[1,"table-bordered","global_table",2,"overflow-x","hidden !important"],[2,"z-index","4"],["style","z-index: 3",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[2,"z-index","3"],[4,"ngIf"],[1,"d-flex","justify-content-center"],[1,"clean","px-2",3,"ngClass"],[1,"dirty","px-2",3,"ngClass"],[1,"overlap"],[1,"rate","first-content"],[1,"second-content"],[3,"style","class",4,"ngIf"],[1,"col","d-flex","justify-content-center","text-truncate"],[1,"text-truncate",2,"margin-left","4px !important"],["class","renovation",3,"width",4,"ngIf"],[1,"renovation"],[1,"d-flex","align-items-center",2,"cursor","pointer"],[1,"col","d-flex","justify-content-center",2,"z-index","0","overflow","hidden","padding-left","4px"],[1,"text-truncate"]],template:function(n,e){n&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),m(5,"Start Date :"),l(),a(6,"div",5)(7,"input",6),T("ngModelChange",function(c){return b(e.Date,c)||(e.Date=c),c}),l()(),a(8,"div",7),m(9,"Week :"),l(),a(10,"div",8)(11,"input",9),T("ngModelChange",function(c){return b(e.Week,c)||(e.Week=c),c}),l(),a(12,"div",10),S("click",function(){return e.add()}),O(),a(13,"svg",11),M(14,"path",12)(15,"path",13),l()(),P(),a(16,"div",14),S("click",function(){return e.sub()}),O(),a(17,"svg",15),M(18,"path",12)(19,"path",16),l()()(),P(),a(20,"div",17)(21,"button",18),S("click",function(){return e.fetchdata()}),m(22," Find "),l()()(),a(23,"div",19)(24,"div",19)(25,"div",20)(26,"div",4),m(27,"Filter :"),l()(),a(28,"div",21)(29,"ng-multiselect-dropdown",22),T("ngModelChange",function(c){return b(e.selectedItems,c)||(e.selectedItems=c),c}),S("onSelect",function(){return e.filterRoom()})("onDeSelect",function(){return e.filterRoom()}),l()()(),a(30,"div",23)(31,"div",24)(32,"div")(33,"div",25),m(34,"Reservation"),l(),a(35,"div",26),m(36,"In house"),l()(),a(37,"div")(38,"div",27),m(39,"Checked out"),l(),a(40,"div",28),m(41,"Maintenance "),l()()()()()()(),a(42,"div",29)(43,"div",30)(44,"div",31)(45,"table",32)(46,"thead")(47,"th",33),m(48,"Room Type"),l(),a(49,"th",33),m(50,"Room"),l(),a(51,"th",33),m(52,"Condition"),l(),u(53,mt,4,4,"th",34),l(),a(54,"tbody"),u(55,St,2,1,"ng-container",35),l()()()()()()),n&2&&(d(7),D("ngModel",e.Date),_("min",e.Max),d(4),D("ngModel",e.Week),_("min",2),d(18),_("placeholder","Select RoomType")("settings",e.dropdownSettings)("data",e.dropdownList),D("ngModel",e.selectedItems),d(24),_("ngForOf",e.DateArr),d(2),_("ngForOf",e.RoomData))},dependencies:[ot,X,et,Z,nt,tt,ct,lt,H,j,$,B,v,rt,Y],styles:[".input_container[_ngcontent-%COMP%]{position:relative;width:20%}.input_img[_ngcontent-%COMP%], .input_img1[_ngcontent-%COMP%]{bottom:2px;top:6px;width:22px;height:22px;position:absolute;cursor:pointer}.input[_ngcontent-%COMP%]{margin:0}.input_img[_ngcontent-%COMP%]{right:5px}.input_img1[_ngcontent-%COMP%]{left:5px}.hide-spinner[_ngcontent-%COMP%]::-webkit-outer-spin-button, .hide-spinner[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.clean[_ngcontent-%COMP%], .dirty[_ngcontent-%COMP%]{column-width:40px}.clean_active[_ngcontent-%COMP%]{background:#6ccfca;border-radius:10px}.dirty_active[_ngcontent-%COMP%]{background:#ffa4a3;border-radius:10px}.checkedout[_ngcontent-%COMP%], .inhouse[_ngcontent-%COMP%], .reservation[_ngcontent-%COMP%]{font-size:13px;font-weight:500;letter-spacing:1px;text-transform:capitalize;margin-left:2px!important;border-radius:10px!important}.reservation[_ngcontent-%COMP%]{background:#bee2f8!important;color:#000}.inhouse[_ngcontent-%COMP%]{background:#6ccfca!important;color:#000}.checkedout[_ngcontent-%COMP%]{background:#1d366d!important;color:#fff}.renovation[_ngcontent-%COMP%]{background:#ffccd1!important;color:#000;font-size:13px;font-weight:500;letter-spacing:1px;text-transform:capitalize;margin-left:2px!important;border-radius:10px!important}.overlap[_ngcontent-%COMP%]{position:relative}.first-content[_ngcontent-%COMP%]{position:absolute;top:-9px;left:40px;z-index:1}.second-content[_ngcontent-%COMP%]{position:absolute;top:-9px;left:0;z-index:2}.global_table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .global_table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:14px}.global_table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(-n+3), .global_table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(-n+3){position:sticky!important;min-width:115px!important;width:115px!important;max-width:115px!important}.global_table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(1), .global_table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(1){left:0!important}.global_table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(2), .global_table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(2){left:115px!important}.global_table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3), .global_table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(3){left:230px!important}.global_table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(-n+3){background:#fff!important}@media only screen and (max-width: 590px){.clean[_ngcontent-%COMP%], .dirty[_ngcontent-%COMP%]{column-width:15px}}"]});let i=s;return i})();export{Rt as TapeChartComponent};

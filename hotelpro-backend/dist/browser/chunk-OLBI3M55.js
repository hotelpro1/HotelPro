import{d as K}from"./chunk-VTR2K2RU.js";import{b as j,c as G,d as E,e as q,f as O,k as $,l as H,m as X,p as B,x as L,y as z,z as J}from"./chunk-JTMYAVLC.js";import{Ba as S,Ca as _,Da as y,Db as A,Fb as P,Ib as U,Jb as b,L as I,La as C,Lb as M,Ma as a,Mb as R,Na as F,Oa as g,R as p,S as u,Xa as k,ea as m,eb as N,fa as x,la as h,na as v,ob as w,pb as D,wa as n,wb as V,xa as i,ya as T}from"./chunk-IHM353DK.js";function Q(l,o){if(l&1){let r=S();n(0,"tr")(1,"th"),a(2),i(),n(3,"td")(4,"a",10),_("click",function(){let e=p(r).$implicit,c=y(),s=C(24);return u(c.openTaxForm(s,e))}),a(5),i()(),n(6,"td"),a(7),i(),n(8,"td"),a(9),i()()}if(l&2){let r=o.$implicit,t=o.index;m(2),F(t+1),m(3),g(" ",r==null?null:r.taxName," "),m(2),g("",r==null?null:r.taxPercentage," %"),m(2),F(r!=null&&r.active?"Active":"Deactive")}}function W(l,o){l&1&&(n(0,"small",26),a(1," Tax Name is required "),i())}function Y(l,o){l&1&&(n(0,"small",26),a(1," Tax Percentage is required and must be at least 1% "),i())}function Z(l,o){if(l&1){let r=S();n(0,"div",11)(1,"h4",12),a(2),i(),n(3,"button",13),_("click",function(){let e=p(r).$implicit;return u(e.dismiss(!1))}),i()(),n(4,"div",14)(5,"form",15)(6,"div",16)(7,"label",17),a(8,"Tax Name"),i(),T(9,"input",18),h(10,W,2,0,"small",19),i(),n(11,"div",16)(12,"label",17),a(13,"Tax Percentage(%)"),i(),T(14,"input",20),h(15,Y,2,0,"small",19),i(),n(16,"div",21),T(17,"input",22),n(18,"label",23),a(19,"Active"),i()()()(),n(20,"div",24)(21,"button",25),_("click",function(){let e=p(r).$implicit;return u(e.close(!0))}),a(22),i()()}if(l&2){let r,t,e=y();m(2),g(" ",e.newTax?"Add Tax":"Update Tax"," "),m(3),v("formGroup",e.taxDetailsForm),m(5),v("ngIf",(((r=e.taxDetailsForm.get("taxName"))==null?null:r.dirty)||((r=e.taxDetailsForm.get("taxName"))==null?null:r.touched))&&((r=e.taxDetailsForm.get("taxName"))==null?null:r.invalid)),m(5),v("ngIf",(((t=e.taxDetailsForm.get("taxPercentage"))==null?null:t.dirty)||((t=e.taxDetailsForm.get("taxPercentage"))==null?null:t.touched))&&((t=e.taxDetailsForm.get("taxPercentage"))==null?null:t.invalid)),m(6),v("disabled",e.taxDetailsForm.invalid),m(),g(" ",e.newTax?"Save":"Update"," ")}}var de=(()=>{let o=class o{constructor(t,e,c,s,f,d){this.fb=t,this.crudService=e,this.alertService=c,this.activeRoute=s,this.modalService=f,this.router=d,this.propertyUnitId="",this.allTaxes=[],this.newTax=!1}ngOnInit(){this.propertyUnitId=this.activeRoute.snapshot.paramMap.get("propertyUnitId"),this.initForm(),this.loadTaxes()}initForm(){this.taxDetailsForm=this.fb.group({_id:[""],taxName:["",[E.required]],taxPercentage:[0,[E.required,E.min(1)]],active:[!1]})}loadTaxes(){if(!this.propertyUnitId){this.alertService.errorAlert("Property Unit ID is missing");return}this.crudService.post(b.GET_ALL_TAXES+this.propertyUnitId).then(t=>{console.log(t),this.allTaxes=t.data}).catch(t=>{this.alertService.errorAlert(t.message),console.log(t)})}openTaxForm(t,e){e?(this.newTax=!1,this.taxDetailsForm.patchValue(e)):(this.newTax=!0,this.taxDetailsForm.reset({_id:"",taxPercentage:0,active:!1})),this.modalService.open(t).result.then(c=>{if(c){if(this.taxDetailsForm.invalid)return;console.log(this.taxDetailsForm.value);let s=this.taxDetailsForm.value;s.propertyUnitId=this.propertyUnitId;let f=e?b.UPDATE_TAX+e._id:b.CREATE_TAX;this.crudService.post(f,s).then(d=>{console.log(d),this.loadTaxes(),this.alertService.successAlert(d.message)}).catch(d=>{this.alertService.errorAlert(d.message),console.log(d)})}})}navigateToRateSetup(){this.router.navigate(["/baserate-setup",this.propertyUnitId])}goToHome(){this.router.navigate(["/client-dashboard"])}};o.\u0275fac=function(e){return new(e||o)(x(L),x(M),x(R),x(A),x(K),x(P))},o.\u0275cmp=I({type:o,selectors:[["app-tax-set"]],standalone:!0,features:[k],decls:25,vars:1,consts:[["taxModal",""],[1,"m-3"],[1,"btn","btn-outline-success",3,"click"],[1,"container-fluid"],[1,"table"],[1,"col"],[4,"ngFor","ngForOf"],[1,"col-md-12","mb-2"],[1,"d-flex","justify-content-center"],["type","button",1,"btn","btn-primary","ms-2",3,"click"],[1,"link",2,"cursor","pointer",3,"click"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup"],[1,"mb-3"],[1,"form-label"],["type","text","placeholder","Enter Tax Name","formControlName","taxName",1,"form-control"],["class","text-danger",4,"ngIf"],["type","number","placeholder","Enter Tax Percentage","formControlName","taxPercentage",1,"form-control"],[1,"mb-3","form-check"],["type","checkbox","formControlName","active",1,"form-check-input"],[1,"form-check-label"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click","disabled"],[1,"text-danger"]],template:function(e,c){if(e&1){let s=S();n(0,"div",1)(1,"button",2),_("click",function(){p(s);let d=C(24);return u(c.openTaxForm(d))}),a(2," Add Tax "),i()(),n(3,"div",3)(4,"table",4)(5,"thead")(6,"tr")(7,"th",5),a(8,"Sr. No"),i(),n(9,"th",5),a(10,"Tax Name"),i(),n(11,"th",5),a(12,"Percentage"),i(),n(13,"th",5),a(14,"Status"),i()()(),n(15,"tbody"),h(16,Q,10,4,"tr",6),i()()(),n(17,"div",7)(18,"div",8)(19,"button",9),_("click",function(){return p(s),u(c.navigateToRateSetup())}),a(20," Back "),i(),n(21,"button",9),_("click",function(){return p(s),u(c.goToHome())}),a(22," Home "),i()()(),h(23,Z,23,6,"ng-template",null,0,N)}e&2&&(m(16),v("ngForOf",c.allTaxes))},dependencies:[V,w,D,z,$,G,H,j,q,O,J,X,B,U]});let l=o;return l})();export{de as TaxSetComponent};

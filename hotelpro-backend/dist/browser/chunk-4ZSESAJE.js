import{b as F,e as j,j as R,y as B}from"./chunk-DKI4PBNW.js";import{a as N,b as O}from"./chunk-3FS5RTN6.js";import{Ba as w,Ca as v,Da as _,Fb as M,Kb as g,L as U,Ma as o,Mb as A,Na as y,Nb as V,Oa as b,R as u,S as h,T as S,Ta as E,Ua as P,Va as T,Xa as k,ea as s,fa as c,ta as C,ua as I,va as x,wa as r,xa as n,ya as D}from"./chunk-W7CJDNGE.js";function $(p,a){if(p&1){let d=w();r(0,"tr")(1,"th",16),o(2),n(),r(3,"td"),o(4),n(),r(5,"td")(6,"div",17)(7,"div",18)(8,"input",19),T("ngModelChange",function(i){let e=u(d).$implicit;return P(e.active,i)||(e.active=i),h(i)}),v("change",function(){let i=u(d).$implicit,e=_();return h(e.updatePropertyUnitStatus(i))}),n()()()(),r(9,"td")(10,"button",20),v("click",function(){let i=u(d).$implicit,e=_();return h(e.editPropertyUnit(i._id))}),o(11,"Edit"),n()(),r(12,"td",21),S(),r(13,"svg",22),v("click",function(){let i=u(d).$implicit,e=_();return h(e.manageUser(i._id))}),D(14,"path",23),n()()()}if(p&2){let d=a.$implicit,t=a.$index;s(2),y(t+1),s(2),y(d.propertyUnitName),s(4),E("ngModel",d.active)}}var Q=(()=>{let a=class a{constructor(t,i,e,l,m){this.authService=t,this.userService=i,this.router=e,this.crudService=l,this.alertService=m,this.activePropertyUnit=0}ngOnInit(){this.userInfo=this.authService.getUserInfo()?.user,console.log(this.userInfo);let t={};this.userInfo.userType=="manager"?t={accessPropertyUnitIds:this.userInfo.accessPropertyUnitIds}:t={propertyId:this.userInfo.propertyId},this.crudService.post(g.READ_CLIENT_DASHBOARD,t).then(i=>{this.dashboardData=i.data,this.activePropertyUnit=0;for(let e of this.dashboardData?.property?.propertyUnits)this.activePropertyUnit+=e.active==!0?1:0;console.log(this.dashboardData)}).catch(i=>{this.alertService.errorAlert(i?.error?.message||i.message)})}updatePropertyUnitStatus(t){this.crudService.post(g.UPDATE_PROPERTY_UNIT_STATUS+t._id,{active:t.active}).then(i=>{console.log(i);let e=this.userService.getUserInfo();t.active?(e.user.propertyUnitId||(e.user.propertyUnitId=t._id),e.user.propertyUnitCode||(e.user.propertyUnitCode=t.propertyUnitCode),e.user.propertyUnitName||(e.user.propertyUnitName=t.propertyUnitName),e.user.propertyUnits.push(t)):(e.user.propertyUnits=e.user.propertyUnits.filter(l=>l._id!=t._id),e.user.propertyUnitId===t._id&&(e.user.propertyUnits?.length>0?(e.user.propertyUnitId=e.user.propertyUnits[0]._id,e.user.propertyUnitCode=e.user.propertyUnits[0].propertyUnitCode,e.user.propertyUnitName=e.user.propertyUnits[0].propertyUnitName):(delete e.user.propertyUnitId,delete e.user.propertyUnitCode,delete e.user.propertyUnitName))),this.userService.updateUserInfo(e),this.ngOnInit()}).catch(i=>{this.alertService.errorAlert(i?.error?.message||i.message)})}addPropertyUnit(){this.router.navigate(["/property-setup/ADD"])}editPropertyUnit(t){this.router.navigate(["/property-setup",t])}manageUser(t){this.router.navigate(["/manage-user",t])}};a.\u0275fac=function(i){return new(i||a)(c(O),c(N),c(M),c(A),c(V))},a.\u0275cmp=U({type:a,selectors:[["app-client-dashboard"]],standalone:!0,features:[k],decls:58,vars:4,consts:[[1,"container-fluid","my-4"],[1,"row"],[1,"col-lg-3","col-md-6","mb-4"],[1,"card","shadow"],[1,"card-body"],[1,"card-title"],[1,"card-text"],[1,"row","mb-4"],[1,"col-12"],[1,"card"],[1,"card-header"],[1,"table","table-striped","text-center"],["scope","col"],[1,"col-12","text-center"],[1,"btn","btn-primary","mx-2",3,"click"],[1,"btn","btn-danger","mx-2"],["scope","row"],[1,"d-flex","justify-content-center"],[1,"form-check","form-switch"],["type","checkbox","role","switch","id","flexSwitchCheckDefault",1,"form-check-input",3,"ngModelChange","change","ngModel"],[1,"btn","btn-secondary","btn-sm",3,"click"],[2,"text-align","center"],["xmlns","http://www.w3.org/2000/svg","width","26","height","26","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-person",2,"cursor","pointer",3,"click"],["d","M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"]],template:function(i,e){if(i&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h5",5),o(6,"Total Properties"),n(),r(7,"p",6),o(8),n()()()(),r(9,"div",2)(10,"div",3)(11,"div",4)(12,"h5",5),o(13,"Active Properties"),n(),r(14,"p",6),o(15),n()()()(),r(16,"div",2)(17,"div",3)(18,"div",4)(19,"h5",5),o(20,"Total Rooms"),n(),r(21,"p",6),o(22),n()()()(),r(23,"div",2)(24,"div",3)(25,"div",4)(26,"h5",5),o(27,"Total staff"),n(),r(28,"p",6),o(29),n()()()()(),r(30,"div",7)(31,"div",8)(32,"div",9)(33,"div",10),o(34," Property Units "),n(),r(35,"div",4)(36,"table",11)(37,"thead")(38,"tr")(39,"th",12),o(40,"No."),n(),r(41,"th",12),o(42,"Property Unit Name"),n(),r(43,"th",12),o(44,"Status"),n(),r(45,"th",12),o(46,"Actions"),n(),r(47,"th",12),o(48,"Manage User"),n()()(),r(49,"tbody"),I(50,$,15,3,"tr",null,C),n()()()()()(),r(52,"div",1)(53,"div",13)(54,"button",14),v("click",function(){return e.addPropertyUnit()}),o(55,"Add Property"),n(),r(56,"button",15),o(57,"Subscribe"),n()()()()),i&2){let l,m,f;s(8),y((l=e.dashboardData==null||e.dashboardData.property==null||e.dashboardData.property.propertyUnits==null?null:e.dashboardData.property.propertyUnits.length)!==null&&l!==void 0?l:0),s(7),y(e.activePropertyUnit),s(7),b(" ",(m=e.dashboardData==null||e.dashboardData.rooms==null?null:e.dashboardData.rooms.totalRooms)!==null&&m!==void 0?m:0," "),s(7),b(" ",(f=e.dashboardData==null||e.dashboardData.users==null?null:e.dashboardData.users.totalUsers)!==null&&f!==void 0?f:0," "),s(21),x(e.dashboardData==null||e.dashboardData.property==null?null:e.dashboardData.property.propertyUnits)}},dependencies:[B,F,j,R],styles:["body[_ngcontent-%COMP%]{background-color:#f8f9fa}.navbar-brand[_ngcontent-%COMP%]{font-size:1.5rem}.card-header[_ngcontent-%COMP%]{font-weight:700}.card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem}"]});let p=a;return p})();export{Q as ClientDashboardComponent};

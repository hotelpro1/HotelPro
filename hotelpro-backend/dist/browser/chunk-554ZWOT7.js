import{a as Q}from"./chunk-EH34FAH4.js";import{d as K}from"./chunk-A2YF7YV6.js";import{b as j,c as G,d as y,e as q,f as O,k as $,l as H,m as X,p as B,x as L,y as z,z as J}from"./chunk-HSWBAXOQ.js";import{Ca as S,Da as _,Ea as E,Eb as A,Gb as P,Kb as U,Lb as b,M as I,Ma as C,Na as r,Nb as M,Oa as F,Ob as R,Pa as T,S as p,T as u,Ya as k,fa as m,fb as N,ga as x,ma as h,oa as v,pb as w,qb as D,xa as n,xb as V,ya as t,za as g}from"./chunk-OZVGGEGK.js";function W(l,o){if(l&1){let a=S();n(0,"tr")(1,"th"),r(2),t(),n(3,"td")(4,"a",13),_("click",function(){let e=p(a).$implicit,c=E(),s=C(28);return u(c.openTaxForm(s,e))}),r(5),t()(),n(6,"td"),r(7),t(),n(8,"td"),r(9),t()()}if(l&2){let a=o.$implicit,i=o.index;m(2),F(i+1),m(3),T(" ",a==null?null:a.taxName," "),m(2),T("",a==null?null:a.taxPercentage," %"),m(2),F(a!=null&&a.active?"Active":"Deactive")}}function Y(l,o){l&1&&(n(0,"small",29),r(1," Tax Name is required "),t())}function Z(l,o){l&1&&(n(0,"small",29),r(1," Tax Percentage is required and must be at least 1% "),t())}function ee(l,o){if(l&1){let a=S();n(0,"div",14)(1,"h4",15),r(2),t(),n(3,"button",16),_("click",function(){let e=p(a).$implicit;return u(e.dismiss(!1))}),t()(),n(4,"div",17)(5,"form",18)(6,"div",19)(7,"label",20),r(8,"Tax Name"),t(),g(9,"input",21),h(10,Y,2,0,"small",22),t(),n(11,"div",19)(12,"label",20),r(13,"Tax Percentage(%)"),t(),g(14,"input",23),h(15,Z,2,0,"small",22),t(),n(16,"div",24),g(17,"input",25),n(18,"label",26),r(19,"Active"),t()()()(),n(20,"div",27)(21,"button",28),_("click",function(){let e=p(a).$implicit;return u(e.close(!0))}),r(22),t()()}if(l&2){let a,i,e=E();m(2),T(" ",e.newTax?"Add Tax":"Update Tax"," "),m(3),v("formGroup",e.taxDetailsForm),m(5),v("ngIf",(((a=e.taxDetailsForm.get("taxName"))==null?null:a.dirty)||((a=e.taxDetailsForm.get("taxName"))==null?null:a.touched))&&((a=e.taxDetailsForm.get("taxName"))==null?null:a.invalid)),m(5),v("ngIf",(((i=e.taxDetailsForm.get("taxPercentage"))==null?null:i.dirty)||((i=e.taxDetailsForm.get("taxPercentage"))==null?null:i.touched))&&((i=e.taxDetailsForm.get("taxPercentage"))==null?null:i.invalid)),m(6),v("disabled",e.taxDetailsForm.invalid),m(),T(" ",e.newTax?"Save":"Update"," ")}}var ue=(()=>{let o=class o{constructor(i,e,c,s,f,d){this.fb=i,this.crudService=e,this.alertService=c,this.activeRoute=s,this.modalService=f,this.router=d,this.propertyUnitId="",this.allTaxes=[],this.newTax=!1}ngOnInit(){this.propertyUnitId=this.activeRoute.snapshot.paramMap.get("propertyUnitId"),this.initForm(),this.loadTaxes()}initForm(){this.taxDetailsForm=this.fb.group({_id:[""],taxName:["",[y.required]],taxPercentage:[0,[y.required,y.min(1)]],active:[!1]})}loadTaxes(){if(!this.propertyUnitId){this.alertService.errorAlert("Property Unit ID is missing");return}this.crudService.post(b.GET_ALL_TAXES+this.propertyUnitId).then(i=>{console.log(i),this.allTaxes=i.data}).catch(i=>{this.alertService.errorAlert(i.message),console.log(i)})}openTaxForm(i,e){e?(this.newTax=!1,this.taxDetailsForm.patchValue(e)):(this.newTax=!0,this.taxDetailsForm.reset({_id:"",taxPercentage:0,active:!1})),this.modalService.open(i).result.then(c=>{if(c){if(this.taxDetailsForm.invalid)return;console.log(this.taxDetailsForm.value);let s=this.taxDetailsForm.value;s.propertyUnitId=this.propertyUnitId;let f=e?b.UPDATE_TAX+e._id:b.CREATE_TAX;this.crudService.post(f,s).then(d=>{console.log(d),this.loadTaxes(),this.alertService.successAlert(d.message)}).catch(d=>{this.alertService.errorAlert(d.message),console.log(d)})}})}navigateToRateSetup(){this.router.navigate(["/baserate-setup",this.propertyUnitId])}goToHome(){this.router.navigate(["/client-dashboard"])}};o.\u0275fac=function(e){return new(e||o)(x(L),x(M),x(R),x(A),x(K),x(P))},o.\u0275cmp=I({type:o,selectors:[["app-tax-set"]],standalone:!0,features:[k],decls:29,vars:1,consts:[["taxModal",""],[1,"row","g-0"],[1,"col-9","ps-5","pe-3"],[1,"m-3"],[1,"btn","btn-outline-success",3,"click"],[1,"container-fluid"],[1,"table"],[1,"col"],[4,"ngFor","ngForOf"],[1,"col-md-12","mb-2"],[1,"d-flex","justify-content-center"],["type","button",1,"btn","btn-primary","ms-2",3,"click"],[1,"col-3","px-3"],[1,"link",2,"cursor","pointer",3,"click"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup"],[1,"mb-3"],[1,"form-label"],["type","text","placeholder","Enter Tax Name","formControlName","taxName",1,"form-control"],["class","text-danger",4,"ngIf"],["type","number","placeholder","Enter Tax Percentage","formControlName","taxPercentage",1,"form-control"],[1,"mb-3","form-check"],["type","checkbox","formControlName","active",1,"form-check-input"],[1,"form-check-label"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click","disabled"],[1,"text-danger"]],template:function(e,c){if(e&1){let s=S();n(0,"div",1)(1,"div",2)(2,"div",3)(3,"button",4),_("click",function(){p(s);let d=C(28);return u(c.openTaxForm(d))}),r(4," Add Tax "),t()(),n(5,"div",5)(6,"table",6)(7,"thead")(8,"tr")(9,"th",7),r(10,"Sr. No"),t(),n(11,"th",7),r(12,"Tax Name"),t(),n(13,"th",7),r(14,"Percentage"),t(),n(15,"th",7),r(16,"Status"),t()()(),n(17,"tbody"),h(18,W,10,4,"tr",8),t()()(),n(19,"div",9)(20,"div",10)(21,"button",11),_("click",function(){return p(s),u(c.navigateToRateSetup())}),r(22," Back "),t(),n(23,"button",11),_("click",function(){return p(s),u(c.goToHome())}),r(24," Home "),t()()()(),n(25,"div",12),g(26,"app-property-sidebar"),t()(),h(27,ee,23,6,"ng-template",null,0,N)}e&2&&(m(18),v("ngForOf",c.allTaxes))},dependencies:[V,w,D,z,$,G,H,j,q,O,J,X,B,U,Q]});let l=o;return l})();export{ue as TaxSetComponent};
